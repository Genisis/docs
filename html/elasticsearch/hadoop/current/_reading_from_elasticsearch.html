<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Reading from Elasticsearch</title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch for Apache Hadoop" /><link rel="up" href="architecture.html" title="Architecture" /><link rel="prev" href="_map_reduce_and_shards.html" title="Map/Reduce and Shards" /><link rel="next" href="_writing_to_elasticsearch.html" title="Writing to Elasticsearch" /><script type="text/javascript" src="http://www.elasticsearch.org/wp-includes/js/jquery/jquery.js?ver=1.8.3"></script><link rel="stylesheet" id="prettify-gc-syntax-highlighter-css" href="http://www.elasticsearch.org/content/plugins/prettify-gc-syntax-highlighter/prettify.css?ver=3.5.2" type="text/css" media="all" /><link rel="stylesheet" id="appStyles-css" href="http://www.elasticsearch.org/content/themes/elasticsearch-org/css/main.css?ver=1376314515" type="text/css" media="all" /><script type="text/javascript" src="http://www.elasticsearch.org/content/themes/elasticsearch-org/js/vendor/modernizr-2.6.1.min.js?ver=1"></script><script type="text/javascript" src="http://www.elasticsearch.org/content/themes/elasticsearch-org/js/vendor/selectivizr-min.js?ver=1"></script><script type="text/javascript" src="http://www.elasticsearch.org/content/themes/elasticsearch-org/js/plugins.min.js?ver=1375472072"></script><link rel="stylesheet" type="text/css" href="styles.css" /></head><body class="single single-guide"><div class="global_wrapper"><div id="index" class="page_content"><div class="container"><section class="full_width guide"><article class="guide_content"><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch for Apache Hadoop</a></span> &gt; <span class="breadcrumb-link"><a href="_reference.html">Reference</a></span> &gt; <span class="breadcrumb-link"><a href="architecture.html">Architecture</a></span> &gt; <span class="breadcrumb-node">Reading from Elasticsearch</span></div><div class="navheader"><span class="prev"><a href="_map_reduce_and_shards.html">
              « 
              Map/Reduce and Shards</a>
           
        </span><span class="next">
           
          <a href="_writing_to_elasticsearch.html">Writing to Elasticsearch
               » 
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="_reading_from_elasticsearch"></a>Reading from Elasticsearch</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="_map_reduce_and_shards.html">Map/Reduce and Shards</a></span></dt><dt><span class="section"><a href="_reading_from_elasticsearch.html">Reading from Elasticsearch</a></span></dt><dt><span class="section"><a href="_writing_to_elasticsearch.html">Writing to Elasticsearch</a></span></dt><dt><span class="section"><a href="_data_co_location.html">Data co-location</a></span></dt></dl></div><p>Shards play a critical role when reading information from Elasticsearch. Since it acts as a source, elasticsearch-hadoop will create one Hadoop <code class="literal">InputSplit</code> per Elasticsearch shard; that is given a query that works against index <code class="literal">I</code>, elasticsearch-hadoop will dynamically discover the number of shards backing <code class="literal">I</code> and then for each shard will create an input split (which will determine the number of Hadoop tasks to be executed).
With the default settings, Elasticsearch uses <span class="strong"><strong>5</strong></span> <a class="ulink" href="http://www.elasticsearch.org/guide/elasticsearch/reference/current/glossary.html#glossary-primary-shard" target="_top"><code class="literal">primary</code></a> shards per index which will result in the same number of tasks on the Hadoop side for each query.</p><div class="note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/icons/note.png" /></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>elasticsearch-hadoop does not query the same shards - it iterates through all of them (primaries and replicas) using a round-robin approach. To avoid data duplication, only one shard is used from each shard group (primary and replicas).</p></td></tr></table></div><p>A common concern (read optimization) for improving performance is to increase the number of shards and thus increase the number of tasks on the Hadoop side. Unless such gains are demonstrated through benchmarks, we recommend against such a measure since in most cases, an Elasticsearch shard can <span class="strong"><strong>easily</strong></span> handle data streaming to a Hadoop task.</p></div><div class="navfooter"><span class="prev"><a href="_map_reduce_and_shards.html">
              « 
              Map/Reduce and Shards</a>
           
        </span><span class="next">
           
          <a href="_writing_to_elasticsearch.html">Writing to Elasticsearch
               » 
            </a></span></div></article></section></div></div></div><script type="text/javascript" src="http://www.elasticsearch.org/content/plugins/prettify-gc-syntax-highlighter/prettify.js?ver=3.5.2"></script><script type="text/javascript" src="http://www.elasticsearch.org/content/plugins/prettify-gc-syntax-highlighter/launch.js?ver=3.5.2"></script></body></html>
