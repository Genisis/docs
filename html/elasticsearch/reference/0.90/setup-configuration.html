<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head xmlns="http://www.w3.org/1999/xhtml"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Configuration</title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Reference" /><link rel="up" href="setup.html" title="Setup" /><link rel="prev" href="setup.html" title="Setup" /><link rel="next" href="setup-service.html" title="Running As a Service" /><script xmlns="" type="text/javascript" src="http://www.elasticsearch.org/wp-includes/js/jquery/jquery.js?ver=1.8.3"></script><link xmlns="" rel="stylesheet" id="prettify-gc-syntax-highlighter-css" href="http://www.elasticsearch.org/content/plugins/prettify-gc-syntax-highlighter/prettify.css?ver=3.5.2" type="text/css" media="all" /><link xmlns="" rel="stylesheet" id="appStyles-css" href="http://www.elasticsearch.org/content/themes/elasticsearch-org/css/main.css?ver=1376314515" type="text/css" media="all" /><script xmlns="" type="text/javascript" src="http://www.elasticsearch.org/content/themes/elasticsearch-org/js/vendor/modernizr-2.6.1.min.js?ver=1"></script><script xmlns="" type="text/javascript" src="http://www.elasticsearch.org/content/themes/elasticsearch-org/js/vendor/selectivizr-min.js?ver=1"></script><script xmlns="" type="text/javascript" src="http://www.elasticsearch.org/content/themes/elasticsearch-org/js/plugins.min.js?ver=1375472072"></script><link xmlns="" rel="stylesheet" type="text/css" href="styles.css" /></head><body class="single single-guide"><div class="global_wrapper"><div id="index" class="page_content"><div class="container"><section class="full_width guide"><article class="guide_content"><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Reference</a></span> &gt; <span class="breadcrumb-link"><a href="setup.html">Setup</a></span> &gt; <span class="breadcrumb-node">Configuration</span></div><div class="navheader"><span class="prev"><a href="setup.html">
              « 
              Setup</a>
           
        </span><span class="next">
           
          <a href="setup-service.html">Running As a Service
               » 
            </a></span></div><div xmlns="http://www.w3.org/1999/xhtml" class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="setup-configuration"></a>Configuration</h2></div></div></div><div xmlns="" class="toc"><dl><dt xmlns="http://www.w3.org/1999/xhtml"><span class="chapter"><a href="setup-configuration.html">Configuration</a></span></dt><dt xmlns="http://www.w3.org/1999/xhtml"><span class="chapter"><a href="setup-service.html">Running As a Service</a></span></dt><dt xmlns="http://www.w3.org/1999/xhtml"><span class="chapter"><a href="setup-dir-layout.html">Directory Layout</a></span></dt></dl></div><h3><a id="_environment_variables"></a>Environment Variables</h3><p>Within the scripts, ElasticSearch comes with built in <code class="literal">JAVA_OPTS</code> passed
to the JVM started. The most important setting for that is the <code class="literal">-Xmx</code> to
control the maximum allowed memory for the process, and <code class="literal">-Xms</code> to
control the minimum allocated memory for the process (<span class="emphasis"><em>in general, the
more memory allocated to the process, the better</em></span>).</p><p>Most times it is better to leave the default <code class="literal">JAVA_OPTS</code> as they are,
and use the <code class="literal">ES_JAVA_OPTS</code> environment variable in order to set / change
JVM settings or arguments.</p><p>The <code class="literal">ES_HEAP_SIZE</code> environment variable allows to set the heap memory
that will be allocated to elasticsearch java process. It will allocate
the same value to both min and max values, though those can be set
explicitly (not recommended) by setting <code class="literal">ES_MIN_MEM</code> (defaults to
<code class="literal">256m</code>), and <code class="literal">ES_MAX_MEM</code> (defaults to <code class="literal">1gb</code>).</p><p>It is recommended to set the min and max memory to the same value, and
enable <a class="link" href="setup-configuration.html#setup-configuration-memory" title="Memory Settings"><code class="literal">mlockall</code></a>.</p><h3><a id="_system_configuration"></a>System Configuration</h3><h4><a id="_file_descriptors"></a>File Descriptors</h4><p>Make sure to increase the number of open files descriptors on the
machine (or for the user running elasticsearch). Setting it to 32k or
even 64k is recommended.</p><p>In order to test how many open files the process can open, start it with
<code class="literal">-Des.max-open-files</code> set to <code class="literal">true</code>. This will print the number of open
files the process can open on startup.</p><h4><a id="setup-configuration-memory"></a>Memory Settings</h4><p>There is an option to use
<a class="ulink" href="http://opengroup.org/onlinepubs/007908799/xsh/mlockall.html" target="_top">mlockall</a> to
try to lock the process address space so it won’t be swapped. For this
to work, the <code class="literal">bootstrap.mlockall</code> should be set to <code class="literal">true</code> and it is
recommended to set both the min and max memory allocation to be the
same. Note: This option is only available on Linux/Unix operating
systems.</p><p>In order to see if this works or not, set the <code class="literal">common.jna</code> logging to
DEBUG level. A solution to "Unknown mlockall error 0" can be to set
<code class="literal">ulimit -l unlimited</code>.</p><p>Note, <code class="literal">mlockall</code> might cause the JVM or shell
session to exit if it fails to allocate the memory (because not enough
memory is available on the machine).</p><h3><a id="_elasticsearch_settings"></a>Elasticsearch Settings</h3><p><span class="strong"><strong>elasticsearch</strong></span> configuration files can be found under <code class="literal">ES_HOME/config</code>
folder. The folder comes with two files, the <code class="literal">elasticsearch.yml</code> for
configuring ElasticSearch different
<a class="link" href="modules.html" title="Modules">modules</a>, and <code class="literal">logging.yml</code> for
configuring the ElasticSearch logging.</p><p>The configuration format is <a class="ulink" href="http://www.yaml.org/" target="_top">YAML</a>. Here is an
example of changing the address all network based modules will use to
bind and publish to:</p><pre class="programlisting prettyprint noescape lang-js">network :
    host : 10.0.0.4</pre><p><span class="strong"><strong>elasticsearch</strong></span> configuration files can be found under <code class="literal">ES_HOME/config</code>
folder. The folder comes with two files, the <code class="literal">elasticsearch.yml</code> for
configuring ElasticSearch different <a class="link" href="modules.html" title="Modules">modules</a>, and <code class="literal">logging.yml</code>
for configuring the ElasticSearch logging.</p><h4><a id="_paths"></a>Paths</h4><p>In production use, you will almost certainly want to change paths for
data and log files:</p><pre class="programlisting prettyprint noescape lang-js">path:
  logs: /var/log/elasticsearch
  data: /var/data/elasticsearch</pre><h4><a id="_cluster_name"></a>Cluster name</h4><p>Also, don’t forget to give your production cluster a name, which is used
to discover and auto-join other nodes:</p><pre class="programlisting prettyprint noescape lang-js">cluster:
  name: &lt;NAME OF YOUR CLUSTER&gt;</pre><h4><a id="_node_name"></a>Node name</h4><p>You may also want to change the default node name for each node to
something like the display hostname. By default ElasticSearch will
randomly pick a Marvel character name from a list of around 3000 names
when your node starts up.</p><pre class="programlisting prettyprint noescape lang-js">node:
  name: &lt;NAME OF YOUR NODE&gt;</pre><p>Internally, all settings are collapsed into "namespaced" settings. For
example, the above gets collapsed into <code class="literal">network.host</code>. This means that
its easy to support other configuration formats, for example,
<a class="ulink" href="http://www.json.org" target="_top">JSON</a>. If JSON is a preferred configuration format,
simply rename the <code class="literal">elasticsearch.yml</code> file to <code class="literal">elasticsearch.json</code> and
add:</p><h4><a id="_configuration_styles"></a>Configuration styles</h4><pre class="programlisting prettyprint noescape lang-js">{
    "network" : {
        "host" : "10.0.0.4"
    }
}</pre><p>It also means that its easy to provide the settings externally either
using the <code class="literal">ES_JAVA_OPTS</code> or as parameters to the <code class="literal">elasticsearch</code>
command, for example:</p><pre class="programlisting prettyprint noescape lang-js">$ elasticsearch -f -Des.network.host=10.0.0.4</pre><p>Another option is to set <code class="literal">es.default.</code> prefix instead of <code class="literal">es.</code> prefix,
which means the default setting will be used only if not explicitly set
in the configuration file.</p><p>Another option is to use the <code class="literal">${...}</code> notation within the configuration
file which will resolve to an environment setting, for example:</p><pre class="programlisting prettyprint noescape lang-js">{
    "network" : {
        "host" : "${ES_NET_HOST}"
    }
}</pre><p>The location of the configuration file can be set externally using a
system property:</p><pre class="programlisting prettyprint noescape lang-js">$ elasticsearch -f -Des.config=/path/to/config/file</pre><h3><a id="_index_settings"></a>Index Settings</h3><p>Indices created within the cluster can provide their own settings. For
example, the following creates an index with memory based storage
instead of the default file system based one (the format can be either
YAML or JSON):</p><pre class="programlisting prettyprint noescape lang-js">$ curl -XPUT http://localhost:9200/kimchy/ -d \
'
index :
    store:
        type: memory
'</pre><p>Index level settings can be set on the node level as well, for example,
within the <code class="literal">elasticsearch.yml</code> file, the following can be set:</p><pre class="programlisting prettyprint noescape lang-js">index :
    store:
        type: memory</pre><p>This means that every index that gets created on the specific node
started with the mentioned configuration will store the index in memory
<span class="strong"><strong>unless the index explicitly sets it</strong></span>. In other words, any index level
settings override what is set in the node configuration. Of course, the
above can also be set as a "collapsed" setting, for example:</p><pre class="programlisting prettyprint noescape lang-js">$ elasticsearch -f -Des.index.store.type=memory</pre><p>All of the index level configuration can be found within each
<a class="link" href="index-modules.html" title="Index Modules">index module</a>.</p><h3><a id="_logging"></a>Logging</h3><p>ElasticSearch uses an internal logging abstraction and comes, out of the
box, with <a class="ulink" href="http://logging.apache.org/log4j/" target="_top">log4j</a>. It tries to simplify
log4j configuration by using <a class="ulink" href="http://www.yaml.org/" target="_top">YAML</a> to configure it,
and the logging configuration file is <code class="literal">config/logging.yml</code> file.</p></div><div class="navfooter"><span class="prev"><a href="setup.html">
              « 
              Setup</a>
           
        </span><span class="next">
           
          <a href="setup-service.html">Running As a Service
               » 
            </a></span></div></article></section></div></div></div><script type="text/javascript" src="http://www.elasticsearch.org/content/plugins/prettify-gc-syntax-highlighter/prettify.js?ver=3.5.2"></script><script type="text/javascript" src="http://www.elasticsearch.org/content/plugins/prettify-gc-syntax-highlighter/launch.js?ver=3.5.2"></script></body></html>
