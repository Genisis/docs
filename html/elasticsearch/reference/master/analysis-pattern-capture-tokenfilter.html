<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head xmlns="http://www.w3.org/1999/xhtml"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Pattern Capture Token Filter</title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Reference" /><link rel="up" href="analysis-tokenfilters.html" title="Token Filters" /><link rel="prev" href="analysis-unique-tokenfilter.html" title="Unique Token Filter" /><link rel="next" href="analysis-pattern_replace-tokenfilter.html" title="Pattern Replace Token Filter" /><script xmlns="" type="text/javascript" src="http://www.elasticsearch.org/wp-includes/js/jquery/jquery.js?ver=1.8.3"></script><link xmlns="" rel="stylesheet" id="prettify-gc-syntax-highlighter-css" href="http://www.elasticsearch.org/content/plugins/prettify-gc-syntax-highlighter/prettify.css?ver=3.5.2" type="text/css" media="all" /><link xmlns="" rel="stylesheet" id="appStyles-css" href="http://www.elasticsearch.org/content/themes/elasticsearch-org/css/main.css?ver=1376314515" type="text/css" media="all" /><script xmlns="" type="text/javascript" src="http://www.elasticsearch.org/content/themes/elasticsearch-org/js/vendor/modernizr-2.6.1.min.js?ver=1"></script><script xmlns="" type="text/javascript" src="http://www.elasticsearch.org/content/themes/elasticsearch-org/js/vendor/selectivizr-min.js?ver=1"></script><script xmlns="" type="text/javascript" src="http://www.elasticsearch.org/content/themes/elasticsearch-org/js/plugins.min.js?ver=1375472072"></script><link xmlns="" rel="stylesheet" type="text/css" href="styles.css" /></head><body class="single single-guide"><div class="global_wrapper"><div id="index" class="page_content"><div class="container"><section class="full_width guide"><article class="guide_content"><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Reference</a></span> &gt; <span class="breadcrumb-link"><a href="analysis.html">Analysis</a></span> &gt; <span class="breadcrumb-link"><a href="analysis-tokenfilters.html">Token Filters</a></span> &gt; <span class="breadcrumb-node">Pattern Capture Token Filter</span></div><div class="navheader"><span class="prev"><a href="analysis-unique-tokenfilter.html">
              « 
              Unique Token Filter</a>
           
        </span><span class="next">
           
          <a href="analysis-pattern_replace-tokenfilter.html">Pattern Replace Token Filter
               » 
            </a></span></div><div xmlns="http://www.w3.org/1999/xhtml" class="section"><div class="titlepage"><div><div><h2 class="title"><a id="analysis-pattern-capture-tokenfilter"></a>Pattern Capture Token Filter</h2></div></div></div><div xmlns="" class="toc"><dl><dt xmlns="http://www.w3.org/1999/xhtml"><span class="section"><a href="analysis-standard-tokenfilter.html">Standard Token Filter</a></span></dt><dt xmlns="http://www.w3.org/1999/xhtml"><span class="section"><a href="analysis-asciifolding-tokenfilter.html">ASCII Folding Token Filter</a></span></dt><dt xmlns="http://www.w3.org/1999/xhtml"><span class="section"><a href="analysis-length-tokenfilter.html">Length Token Filter</a></span></dt><dt xmlns="http://www.w3.org/1999/xhtml"><span class="section"><a href="analysis-lowercase-tokenfilter.html">Lowercase Token Filter</a></span></dt><dt xmlns="http://www.w3.org/1999/xhtml"><span class="section"><a href="analysis-ngram-tokenfilter.html">NGram Token Filter</a></span></dt><dt xmlns="http://www.w3.org/1999/xhtml"><span class="section"><a href="analysis-edgengram-tokenfilter.html">Edge NGram Token Filter</a></span></dt><dt xmlns="http://www.w3.org/1999/xhtml"><span class="section"><a href="analysis-porterstem-tokenfilter.html">Porter Stem Token Filter</a></span></dt><dt xmlns="http://www.w3.org/1999/xhtml"><span class="section"><a href="analysis-shingle-tokenfilter.html">Shingle Token Filter</a></span></dt><dt xmlns="http://www.w3.org/1999/xhtml"><span class="section"><a href="analysis-stop-tokenfilter.html">Stop Token Filter</a></span></dt><dt xmlns="http://www.w3.org/1999/xhtml"><span class="section"><a href="analysis-word-delimiter-tokenfilter.html">Word Delimiter Token Filter</a></span></dt><dt xmlns="http://www.w3.org/1999/xhtml"><span class="section"><a href="analysis-stemmer-tokenfilter.html">Stemmer Token Filter</a></span></dt><dt xmlns="http://www.w3.org/1999/xhtml"><span class="section"><a href="analysis-stemmer-override-tokenfilter.html">Stemmer Override Token Filter</a></span></dt><dt xmlns="http://www.w3.org/1999/xhtml"><span class="section"><a href="analysis-keyword-marker-tokenfilter.html">Keyword Marker Token Filter</a></span></dt><dt xmlns="http://www.w3.org/1999/xhtml"><span class="section"><a href="analysis-keyword-repeat-tokenfilter.html">Keyword Repeat Token Filter</a></span></dt><dt xmlns="http://www.w3.org/1999/xhtml"><span class="section"><a href="analysis-kstem-tokenfilter.html">KStem Token Filter</a></span></dt><dt xmlns="http://www.w3.org/1999/xhtml"><span class="section"><a href="analysis-snowball-tokenfilter.html">Snowball Token Filter</a></span></dt><dt xmlns="http://www.w3.org/1999/xhtml"><span class="section"><a href="analysis-phonetic-tokenfilter.html">Phonetic Token Filter</a></span></dt><dt xmlns="http://www.w3.org/1999/xhtml"><span class="section"><a href="analysis-synonym-tokenfilter.html">Synonym Token Filter</a></span></dt><dt xmlns="http://www.w3.org/1999/xhtml"><span class="section"><a href="analysis-compound-word-tokenfilter.html">Compound Word Token Filter</a></span></dt><dt xmlns="http://www.w3.org/1999/xhtml"><span class="section"><a href="analysis-reverse-tokenfilter.html">Reverse Token Filter</a></span></dt><dt xmlns="http://www.w3.org/1999/xhtml"><span class="section"><a href="analysis-elision-tokenfilter.html">Elision Token Filter</a></span></dt><dt xmlns="http://www.w3.org/1999/xhtml"><span class="section"><a href="analysis-truncate-tokenfilter.html">Truncate Token Filter</a></span></dt><dt xmlns="http://www.w3.org/1999/xhtml"><span class="section"><a href="analysis-unique-tokenfilter.html">Unique Token Filter</a></span></dt><dt xmlns="http://www.w3.org/1999/xhtml"><span class="section"><a href="analysis-pattern-capture-tokenfilter.html">Pattern Capture Token Filter</a></span></dt><dt xmlns="http://www.w3.org/1999/xhtml"><span class="section"><a href="analysis-pattern_replace-tokenfilter.html">Pattern Replace Token Filter</a></span></dt><dt xmlns="http://www.w3.org/1999/xhtml"><span class="section"><a href="analysis-trim-tokenfilter.html">Trim Token Filter</a></span></dt><dt xmlns="http://www.w3.org/1999/xhtml"><span class="section"><a href="analysis-limit-token-count-tokenfilter.html">Limit Token Count Token Filter</a></span></dt><dt xmlns="http://www.w3.org/1999/xhtml"><span class="section"><a href="analysis-hunspell-tokenfilter.html">Hunspell Token Filter</a></span></dt><dt xmlns="http://www.w3.org/1999/xhtml"><span class="section"><a href="analysis-common-grams-tokenfilter.html">Common Grams Token Filter</a></span></dt><dt xmlns="http://www.w3.org/1999/xhtml"><span class="section"><a href="analysis-normalization-tokenfilter.html">Normalization Token Filter</a></span></dt></dl></div><p>The <code class="literal">pattern_capture</code> token filter, unlike the <code class="literal">pattern</code> tokenizer,
emits a token for every capture group in the regular expression.
Patterns are not anchored to the beginning and end of the string, so
each pattern can match multiple times, and matches are allowed to
overlap.</p><p>For instance a pattern like :</p><pre class="programlisting prettyprint lang-js">"(([a-z]+)(\d*))"</pre><p>when matched against:</p><pre class="programlisting prettyprint lang-js">"abc123def456"</pre><p>would produce the tokens: [ <code class="literal">abc123</code>, <code class="literal">abc</code>, <code class="literal">123</code>, <code class="literal">def456</code>, <code class="literal">def</code>,
<code class="literal">456</code> ]</p><p>If <code class="literal">preserve_original</code> is set to <code class="literal">true</code> (the default) then it would also
emit the original token: <code class="literal">abc123def456</code>.</p><p>This is particularly useful for indexing text like camel-case code, eg
<code class="literal">stripHTML</code> where a user may search for <code class="literal">"strip html"</code> or <code class="literal">"striphtml"</code>:</p><pre class="programlisting prettyprint lang-js">curl -XPUT localhost:9200/test/  -d '
{
   "settings" : {
      "analysis" : {
         "filter" : {
            "code" : {
               "type" : "pattern_capture",
               "preserve_original" : 1,
               "patterns" : [
                  "(\\p{Ll}+|\\p{Lu}\\p{Ll}+|\\p{Lu}+)",
                  "(\\d+)"
               ]
            }
         },
         "analyzer" : {
            "code" : {
               "tokenizer" : "pattern",
               "filter" : [ "code", "lowercase" ]
            }
         }
      }
   }
}
'</pre><p>When used to analyze the text</p><pre class="programlisting prettyprint lang-js">import static org.apache.commons.lang.StringEscapeUtils.escapeHtml</pre><p>this emits the tokens: [ <code class="literal">import</code>, <code class="literal">static</code>, <code class="literal">org</code>, <code class="literal">apache</code>, <code class="literal">commons</code>,
<code class="literal">lang</code>, <code class="literal">stringescapeutils</code>, <code class="literal">string</code>, <code class="literal">escape</code>, <code class="literal">utils</code>, <code class="literal">escapehtml</code>,
<code class="literal">escape</code>, <code class="literal">html</code> ]</p><p>Another example is analyzing email addresses:</p><pre class="programlisting prettyprint lang-js">curl -XPUT localhost:9200/test/  -d '
{
   "settings" : {
      "analysis" : {
         "filter" : {
            "email" : {
               "type" : "pattern_capture",
               "preserve_original" : 1,
               "patterns" : [
                  "(\\w+)",
                  "(\\p{L}+)",
                  "(\\d+)",
                  "@(.+)"
               ]
            }
         },
         "analyzer" : {
            "email" : {
               "tokenizer" : "uax_url_email",
               "filter" : [ "email", "lowercase",  "unique" ]
            }
         }
      }
   }
}
'</pre><p>When the above analyzer is used on an email address like:</p><pre class="programlisting prettyprint lang-js">john-smith_123@foo-bar.com</pre><p>it would produce the following tokens: [ <code class="literal">john-smith_123</code>,
<code class="literal">foo-bar.com</code>, <code class="literal">john</code>, <code class="literal">smith_123</code>, <code class="literal">smith</code>, <code class="literal">123</code>, <code class="literal">foo</code>,
<code class="literal">foo-bar.com</code>, <code class="literal">bar</code>, <code class="literal">com</code> ]</p><p>Multiple patterns are required to allow overlapping captures, but also
means that patterns are less dense and easier to understand.</p><p><span class="strong"><strong>Note:</strong></span> All tokens are emitted in the same position, and with the same
character offsets, so when combined with highlighting, the whole
original token will be highlighted, not just the matching subset. For
instance, querying the above email address for <code class="literal">"smith"</code> would
highlight:</p><pre class="programlisting prettyprint lang-js">  &lt;em&gt;john-smith_123@foo-bar.com&lt;/em&gt;</pre><p>not:</p><pre class="programlisting prettyprint lang-js">  john-&lt;em&gt;smith&lt;/em&gt;_123@foo-bar.com</pre></div><div class="navfooter"><span class="prev"><a href="analysis-unique-tokenfilter.html">
              « 
              Unique Token Filter</a>
           
        </span><span class="next">
           
          <a href="analysis-pattern_replace-tokenfilter.html">Pattern Replace Token Filter
               » 
            </a></span></div></article></section></div></div></div><script type="text/javascript" src="http://www.elasticsearch.org/content/plugins/prettify-gc-syntax-highlighter/prettify.js?ver=3.5.2"></script><script type="text/javascript" src="http://www.elasticsearch.org/content/plugins/prettify-gc-syntax-highlighter/launch.js?ver=3.5.2"></script></body></html>
