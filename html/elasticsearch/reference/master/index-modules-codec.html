<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Codec module</title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Reference" /><link rel="up" href="index-modules.html" title="Index Modules" /><link rel="prev" href="index-modules-fielddata.html" title="Field data" /><link rel="next" href="index-modules-similarity.html" title="Similarity module" /><script type="text/javascript" src="http://www.elasticsearch.org/wp-includes/js/jquery/jquery.js?ver=1.8.3"></script><link rel="stylesheet" id="prettify-gc-syntax-highlighter-css" href="http://www.elasticsearch.org/content/plugins/prettify-gc-syntax-highlighter/prettify.css?ver=3.5.2" type="text/css" media="all" /><link rel="stylesheet" id="appStyles-css" href="http://www.elasticsearch.org/content/themes/elasticsearch-org/css/main.css?ver=1376314515" type="text/css" media="all" /><script type="text/javascript" src="http://www.elasticsearch.org/content/themes/elasticsearch-org/js/vendor/modernizr-2.6.1.min.js?ver=1"></script><script type="text/javascript" src="http://www.elasticsearch.org/content/themes/elasticsearch-org/js/vendor/selectivizr-min.js?ver=1"></script><script type="text/javascript" src="http://www.elasticsearch.org/content/themes/elasticsearch-org/js/plugins.min.js?ver=1375472072"></script><link rel="stylesheet" type="text/css" href="styles.css" /></head><body class="single single-guide"><div class="global_wrapper"><div id="index" class="page_content"><div class="container"><section class="full_width guide"><article class="guide_content"><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Reference</a></span> &gt; <span class="breadcrumb-link"><a href="index-modules.html">Index Modules</a></span> &gt; <span class="breadcrumb-node">Codec module</span></div><div class="navheader"><span class="prev"><a href="index-modules-fielddata.html">
              « 
              Field data</a>
           
        </span><span class="next">
           
          <a href="index-modules-similarity.html">Similarity module
               » 
            </a></span></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="index-modules-codec"></a>Codec module</h2></div></div></div><div class="toc"><dl><dt><span class="chapter"><a href="index-modules-analysis.html">Analysis</a></span></dt><dt><span class="chapter"><a href="index-modules-allocation.html">Index Shard Allocation</a></span></dt><dt><span class="chapter"><a href="index-modules-slowlog.html">Index Slow Log</a></span></dt><dt><span class="chapter"><a href="index-modules-merge.html">Merge</a></span></dt><dt><span class="chapter"><a href="index-modules-store.html">Store</a></span></dt><dt><span class="chapter"><a href="index-modules-mapper.html">Mapper</a></span></dt><dt><span class="chapter"><a href="index-modules-translog.html">Translog</a></span></dt><dt><span class="chapter"><a href="index-modules-cache.html">Cache</a></span></dt><dt><span class="chapter"><a href="index-modules-fielddata.html">Field data</a></span></dt><dt><span class="chapter"><a href="index-modules-codec.html">Codec module</a></span></dt><dt><span class="chapter"><a href="index-modules-similarity.html">Similarity module</a></span></dt></dl></div><p>Codecs define how documents are written to disk and read from disk. The
postings format is the part of the codec that responsible for reading
and writing the term dictionary, postings lists and positions, payloads
and offsets stored in the postings list.</p><p>Configuring custom postings formats is an expert feature and most likely
using the builtin postings formats will suite your needs as is described
in the <a class="link" href="mapping-core-types.html" title="Core Types">mapping section</a></p><h3><a id="_configuring_a_custom_postings_format"></a>Configuring a custom postings format</h3><p>Custom postings format can be defined in the index settings in the
<code class="literal">codec</code> part. The <code class="literal">codec</code> part can be configured when creating an index
or updating index settings. An example on how to define your custom
postings format:</p><pre class="programlisting prettyprint lang-js">curl -XPUT 'http://localhost:9200/twitter/' -d '{
    "settings" : {
        "index" : {
            "codec" : {
          "postings_format" : {
             "my_format" : {
                "type" : "pulsing",
                "freq_cut_off" : "5"
             }
          }
       }
        }
    }
}'</pre><p>Then we defining your mapping your can use the <code class="literal">my_format</code> name in the
<code class="literal">postings_format</code> option as the example below illustrates:</p><pre class="programlisting prettyprint lang-js">{
  "person" : {
     "properties" : {
         "second_person_id" : {"type" : "string", "postings_format" : "my_format"}
     }
  }
}</pre><h3><a id="_available_postings_formats"></a>Available postings formats</h3><h4><a id="_direct_postings_format"></a>Direct postings format</h4><p>Wraps the default postings format for on-disk storage, but then at read
time loads and stores all terms &amp; postings directly in RAM. This
postings format makes no effort to compress the terms and posting list
and therefore is memory intensive, but because of this it gives a
substantial increase in search performance. Because this holds all term
bytes as a single byte[], you cannot have more than 2.1GB worth of terms
in a single segment.</p><p>This postings format offers the following parameters:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">
<code class="literal">min_skip_count</code>
</span></dt><dd>
    The minimum number terms with a shared prefix to
    allow a skip pointer to be written. The default is <span class="strong"><strong>8</strong></span>.
</dd><dt><span class="term">
<code class="literal">low_freq_cutoff</code>
</span></dt><dd>
    Terms with a lower document frequency use a
    single array object representation for postings and positions. The
    default is <span class="strong"><strong>32</strong></span>.
</dd></dl></div><p>Type name: <code class="literal">direct</code></p><h4><a id="_memory_postings_format"></a>Memory postings format</h4><p>A postings format that stores terms &amp; postings (docs, positions,
payloads) in RAM, using an FST. This postings format does write to disk,
but loads everything into memory. The memory postings format has the
following options:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">
<code class="literal">pack_fst</code>
</span></dt><dd>
    A boolean option that defines if the in memory structure
    should be packed once its build. Packed will reduce the size for the
    data-structure in memory but requires more memory during building.
    Default is <span class="strong"><strong>false</strong></span>.
</dd><dt><span class="term">
<code class="literal">acceptable_overhead_ratio</code>
</span></dt><dd>
    The compression ratio specified as a
    float, that is used to compress internal structures. Example ratios <code class="literal">0</code>
    (Compact, no memory overhead at all, but the returned implementation may
    be slow), <code class="literal">0.5</code> (Fast, at most 50% memory overhead, always select a
    reasonably fast implementation), <code class="literal">7</code> (Fastest, at most 700% memory
    overhead, no compression). Default is <code class="literal">0.2</code>.
</dd></dl></div><p>Type name: <code class="literal">memory</code></p><h4><a id="_bloom_filter_posting_format"></a>Bloom filter posting format</h4><p>The bloom filter postings format wraps a delegate postings format and on
top of this creates a bloom filter that is written to disk. During
opening this bloom filter is loaded into memory and used to offer
"fast-fail" reads. This postings format is useful for low doc-frequency
fields such as primary keys. The bloom filter postings format has the
following options:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">
<code class="literal">delegate</code>
</span></dt><dd>
    The name of the configured postings format that the
    bloom filter postings format will wrap.
</dd><dt><span class="term">
<code class="literal">fpp</code>
</span></dt><dd>
    The desired false positive probability specified as a
    floating point number between 0 and 1.0. The <code class="literal">fpp</code> can be configured for
    multiple expected insertions. Example expression: <span class="strong"><strong>10k=0.01,1m=0.03</strong></span>. If
    number docs per index segment is larger than <span class="strong"><strong>1m</strong></span> then use <span class="strong"><strong>0.03</strong></span> as fpp
    and if number of docs per segment is larger than <span class="strong"><strong>10k</strong></span> use <span class="strong"><strong>0.01</strong></span> as
    fpp. The last fallback value is always <span class="strong"><strong>0.03</strong></span>. This example expression
    is also the default.
</dd></dl></div><p>Type name: <code class="literal">bloom</code></p><h4><a id="_pulsing_postings_format"></a>Pulsing postings format</h4><p>The pulsing implementation in-lines the posting lists for very low
frequent terms in the term dictionary. This is useful to improve lookup
performance for low-frequent terms. This postings format offers the
following parameters:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">
<code class="literal">min_block_size</code>
</span></dt><dd>
    The minimum block size the default Lucene term
    dictionary uses to encode on-disk blocks. Defaults to <span class="strong"><strong>25</strong></span>.
</dd><dt><span class="term">
<code class="literal">max_block_size</code>
</span></dt><dd>
    The maximum block size the default Lucene term
    dictionary uses to encode on-disk blocks. Defaults to <span class="strong"><strong>48</strong></span>.
</dd><dt><span class="term">
<code class="literal">freq_cut_off</code>
</span></dt><dd>
    The document frequency cut off where pulsing
    in-lines posting lists into the term dictionary. Terms with a document
    frequency less or equal to the cutoff will be in-lined. The default is
    <span class="strong"><strong>1</strong></span>.
</dd></dl></div><p>Type name: <code class="literal">pulsing</code></p><h4><a id="_default_postings_format"></a>Default postings format</h4><p>The default postings format has the following options:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">
<code class="literal">min_block_size</code>
</span></dt><dd>
    The minimum block size the default Lucene term
    dictionary uses to encode on-disk blocks. Defaults to <span class="strong"><strong>25</strong></span>.
</dd><dt><span class="term">
<code class="literal">max_block_size</code>
</span></dt><dd>
    The maximum block size the default Lucene term
    dictionary uses to encode on-disk blocks. Defaults to <span class="strong"><strong>48</strong></span>.
</dd></dl></div><p>Type name: <code class="literal">default</code></p></div><div class="navfooter"><span class="prev"><a href="index-modules-fielddata.html">
              « 
              Field data</a>
           
        </span><span class="next">
           
          <a href="index-modules-similarity.html">Similarity module
               » 
            </a></span></div></article></section></div></div></div><script type="text/javascript" src="http://www.elasticsearch.org/content/plugins/prettify-gc-syntax-highlighter/prettify.js?ver=3.5.2"></script><script type="text/javascript" src="http://www.elasticsearch.org/content/plugins/prettify-gc-syntax-highlighter/launch.js?ver=3.5.2"></script></body></html>
