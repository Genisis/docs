<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Multi Term Query Rewrite</title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Reference" /><link rel="up" href="query-dsl-queries.html" title="Queries" /><link rel="prev" href="query-dsl-minimum-should-match.html" title="Minimum Should Match" /><link rel="next" href="query-dsl-filters.html" title="Filters" /><script type="text/javascript" src="http://www.elasticsearch.org/wp-includes/js/jquery/jquery.js?ver=1.8.3"></script><link rel="stylesheet" id="prettify-gc-syntax-highlighter-css" href="http://www.elasticsearch.org/content/plugins/prettify-gc-syntax-highlighter/prettify.css?ver=3.5.2" type="text/css" media="all" /><link rel="stylesheet" id="appStyles-css" href="http://www.elasticsearch.org/content/themes/elasticsearch-org/css/main.css?ver=1376314515" type="text/css" media="all" /><script type="text/javascript" src="http://www.elasticsearch.org/content/themes/elasticsearch-org/js/vendor/modernizr-2.6.1.min.js?ver=1"></script><script type="text/javascript" src="http://www.elasticsearch.org/content/themes/elasticsearch-org/js/vendor/selectivizr-min.js?ver=1"></script><script type="text/javascript" src="http://www.elasticsearch.org/content/themes/elasticsearch-org/js/plugins.min.js?ver=1375472072"></script><link rel="stylesheet" type="text/css" href="styles.css" /></head><body class="single single-guide"><div class="global_wrapper"><div id="index" class="page_content"><div class="container"><section class="full_width guide"><article class="guide_content"><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Reference</a></span> &gt; <span class="breadcrumb-link"><a href="query-dsl.html">Query DSL</a></span> &gt; <span class="breadcrumb-link"><a href="query-dsl-queries.html">Queries</a></span> &gt; <span class="breadcrumb-node">Multi Term Query Rewrite</span></div><div class="navheader"><span class="prev"><a href="query-dsl-minimum-should-match.html">
              « 
              Minimum Should Match</a>
           
        </span><span class="next">
           
          <a href="query-dsl-filters.html">Filters
               » 
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="query-dsl-multi-term-rewrite"></a>Multi Term Query Rewrite</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="query-dsl-match-query.html">Match Query</a></span></dt><dt><span class="section"><a href="query-dsl-multi-match-query.html">Multi Match Query</a></span></dt><dt><span class="section"><a href="query-dsl-bool-query.html">Bool Query</a></span></dt><dt><span class="section"><a href="query-dsl-boosting-query.html">Boosting Query</a></span></dt><dt><span class="section"><a href="query-dsl-common-terms-query.html">Common Terms Query</a></span></dt><dt><span class="section"><a href="query-dsl-custom-filters-score-query.html">Custom Filters Score Query</a></span></dt><dt><span class="section"><a href="query-dsl-custom-score-query.html">Custom Score Query</a></span></dt><dt><span class="section"><a href="query-dsl-custom-boost-factor-query.html">Custom Boost Factor Query</a></span></dt><dt><span class="section"><a href="query-dsl-constant-score-query.html">Constant Score Query</a></span></dt><dt><span class="section"><a href="query-dsl-dis-max-query.html">Dis Max Query</a></span></dt><dt><span class="section"><a href="query-dsl-field-query.html">Field Query</a></span></dt><dt><span class="section"><a href="query-dsl-filtered-query.html">Filtered Query</a></span></dt><dt><span class="section"><a href="query-dsl-flt-query.html">Fuzzy Like This Query</a></span></dt><dt><span class="section"><a href="query-dsl-flt-field-query.html">Fuzzy Like This Field Query</a></span></dt><dt><span class="section"><a href="query-dsl-function-score-query.html">Function Score Query</a></span></dt><dt><span class="section"><a href="query-dsl-fuzzy-query.html">Fuzzy Query</a></span></dt><dt><span class="section"><a href="query-dsl-geo-shape-query.html">GeoShape Query</a></span></dt><dt><span class="section"><a href="query-dsl-has-child-query.html">Has Child Query</a></span></dt><dt><span class="section"><a href="query-dsl-has-parent-query.html">Has Parent Query</a></span></dt><dt><span class="section"><a href="query-dsl-ids-query.html">Ids Query</a></span></dt><dt><span class="section"><a href="query-dsl-indices-query.html">Indices Query</a></span></dt><dt><span class="section"><a href="query-dsl-match-all-query.html">Match All Query</a></span></dt><dt><span class="section"><a href="query-dsl-mlt-query.html">More Like This Query</a></span></dt><dt><span class="section"><a href="query-dsl-mlt-field-query.html">More Like This Field Query</a></span></dt><dt><span class="section"><a href="query-dsl-nested-query.html">Nested Query</a></span></dt><dt><span class="section"><a href="query-dsl-prefix-query.html">Prefix Query</a></span></dt><dt><span class="section"><a href="query-dsl-query-string-query.html">Query String Query</a></span></dt><dt><span class="section"><a href="query-dsl-range-query.html">Range Query</a></span></dt><dt><span class="section"><a href="query-dsl-regexp-query.html">Regexp Query</a></span></dt><dt><span class="section"><a href="query-dsl-span-first-query.html">Span First Query</a></span></dt><dt><span class="section"><a href="query-dsl-span-multi-term-query.html">Span Multi Term Query</a></span></dt><dt><span class="section"><a href="query-dsl-span-near-query.html">Span Near Query</a></span></dt><dt><span class="section"><a href="query-dsl-span-not-query.html">Span Not Query</a></span></dt><dt><span class="section"><a href="query-dsl-span-or-query.html">Span Or Query</a></span></dt><dt><span class="section"><a href="query-dsl-span-term-query.html">Span Term Query</a></span></dt><dt><span class="section"><a href="query-dsl-term-query.html">Term Query</a></span></dt><dt><span class="section"><a href="query-dsl-terms-query.html">Terms Query</a></span></dt><dt><span class="section"><a href="query-dsl-top-children-query.html">Top Children Query</a></span></dt><dt><span class="section"><a href="query-dsl-wildcard-query.html">Wildcard Query</a></span></dt><dt><span class="section"><a href="query-dsl-text-query.html">Text Query</a></span></dt><dt><span class="section"><a href="query-dsl-minimum-should-match.html">Minimum Should Match</a></span></dt><dt><span class="section"><a href="query-dsl-multi-term-rewrite.html">Multi Term Query Rewrite</a></span></dt></dl></div><p>Multi term queries, like
<a class="link" href="query-dsl-wildcard-query.html" title="Wildcard Query">wildcard</a> and
<a class="link" href="query-dsl-prefix-query.html" title="Prefix Query">prefix</a> are called
multi term queries and end up going through a process of rewrite. This
also happens on the
<a class="link" href="query-dsl-query-string-query.html" title="Query String Query">query_string</a>.
All of those queries allow to control how they will get rewritten using
the <code class="literal">rewrite</code> parameter:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
When not set, or set to <code class="literal">constant_score_auto</code>, defaults to
automatically choosing either <code class="literal">constant_score_boolean</code> or
<code class="literal">constant_score_filter</code> based on query characteristics.
</li><li class="listitem">
<code class="literal">scoring_boolean</code>: A rewrite method that first translates each term
into a should clause in a boolean query, and keeps the scores as
computed by the query. Note that typically such scores are meaningless
to the user, and require non-trivial CPU to compute, so it’s almost
always better to use <code class="literal">constant_score_auto</code>. This rewrite method will hit
too many clauses failure if it exceeds the boolean query limit (defaults
to <code class="literal">1024</code>).
</li><li class="listitem">
<code class="literal">constant_score_boolean</code>: Similar to <code class="literal">scoring_boolean</code> except scores
are not computed. Instead, each matching document receives a constant
score equal to the query’s boost. This rewrite method will hit too many
clauses failure if it exceeds the boolean query limit (defaults to
<code class="literal">1024</code>).
</li><li class="listitem">
<code class="literal">constant_score_filter</code>: A rewrite method that first creates a private
Filter by visiting each term in sequence and marking all docs for that
term. Matching documents are assigned a constant score equal to the
query’s boost.
</li><li class="listitem">
<code class="literal">top_terms_N</code>: A rewrite method that first translates each term into
should clause in boolean query, and keeps the scores as computed by the
query. This rewrite method only uses the top scoring terms so it will
not overflow boolean max clause count. The <code class="literal">N</code> controls the size of the
top scoring terms to use.
</li><li class="listitem">
<code class="literal">top_terms_boost_N</code>: A rewrite method that first translates each term
into should clause in boolean query, but the scores are only computed as
the boost. This rewrite method only uses the top scoring terms so it
will not overflow the boolean max clause count. The <code class="literal">N</code> controls the
size of the top scoring terms to use.
</li></ul></div></div><div class="navfooter"><span class="prev"><a href="query-dsl-minimum-should-match.html">
              « 
              Minimum Should Match</a>
           
        </span><span class="next">
           
          <a href="query-dsl-filters.html">Filters
               » 
            </a></span></div></article></section></div></div></div><script type="text/javascript" src="http://www.elasticsearch.org/content/plugins/prettify-gc-syntax-highlighter/prettify.js?ver=3.5.2"></script><script type="text/javascript" src="http://www.elasticsearch.org/content/plugins/prettify-gc-syntax-highlighter/launch.js?ver=3.5.2"></script></body></html>
