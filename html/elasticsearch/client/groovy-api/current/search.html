<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Search API</title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Groovy API" /><link rel="up" href="index.html" title="Groovy API" /><link rel="prev" href="delete.html" title="Delete API" /><link rel="next" href="count.html" title="Count API" /><script type="text/javascript" src="http://www.elasticsearch.org/wp-includes/js/jquery/jquery.js?ver=1.8.3"></script><link rel="stylesheet" id="prettify-gc-syntax-highlighter-css" href="http://www.elasticsearch.org/content/plugins/prettify-gc-syntax-highlighter/prettify.css?ver=3.5.2" type="text/css" media="all" /><link rel="stylesheet" id="appStyles-css" href="http://www.elasticsearch.org/content/themes/elasticsearch-org/css/main.css?ver=1376314515" type="text/css" media="all" /><script type="text/javascript" src="http://www.elasticsearch.org/content/themes/elasticsearch-org/js/vendor/modernizr-2.6.1.min.js?ver=1"></script><script type="text/javascript" src="http://www.elasticsearch.org/content/themes/elasticsearch-org/js/vendor/selectivizr-min.js?ver=1"></script><script type="text/javascript" src="http://www.elasticsearch.org/content/themes/elasticsearch-org/js/plugins.min.js?ver=1375472072"></script><link rel="stylesheet" type="text/css" href="styles.css" /></head><body class="single single-guide"><div class="global_wrapper"><div id="index" class="page_content"><div class="container"><section class="full_width guide"><article class="guide_content"><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Groovy API</a></span> &gt; <span class="breadcrumb-node">Search API</span></div><div class="navheader"><span class="prev"><a href="delete.html">
              « 
              Delete API</a>
           
        </span><span class="next">
           
          <a href="count.html">Count API
               » 
            </a></span></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="search"></a>Search API</h1></div></div></div><p>The search API is very similar to the
<a class="ulink" href="http://www.elasticsearch.org/guide/elasticsearch/client/java-api/current/search.html" target="_top">Java search API</a>. The Groovy
extension allows to provide the search source to execute as a <code class="literal">Closure</code>
including the query itself (similar to GORM criteria builder):</p><pre class="programlisting prettyprint lang-js">def search = node.client.search {
    indices "test"
    types "type1"
    source {
        query {
            term(test: "value")
        }
    }
}

search.response.hits.each {SearchHit hit -&gt;
    println "Got hit $hit.id from $hit.index/$hit.type"
}</pre><p>It can also be executed using the "Java API" while still using a closure
for the query:</p><pre class="programlisting prettyprint lang-js">def search = node.client.prepareSearch("test").setQuery({
        term(test: "value")
}).gexecute();

search.response.hits.each {SearchHit hit -&gt;
    println "Got hit $hit.id from $hit.index/$hit.type"
}</pre><p>The format of the search <code class="literal">Closure</code> follows the same JSON syntax as the
<a class="ulink" href="http://www.elasticsearch.org/guide/elasticsearch/reference/current/search-search.html" target="_top">Search API</a> request.</p><h3><a id="_more_examples"></a>More examples</h3><p>Term query where multiple values are provided (see
<a class="ulink" href="http://www.elasticsearch.org/guide/elasticsearch/reference/current/query-dsl-terms-query.html" target="_top">terms</a>):</p><pre class="programlisting prettyprint lang-js">def search = node.client.search {
    indices "test"
    types "type1"
    source {
        query {
            terms(test: ["value1", "value2"])
        }
    }
}</pre><p>Query string (see
<a class="ulink" href="http://www.elasticsearch.org/guide/elasticsearch/reference/current/query-dsl-query-string-query.html" target="_top">query string</a>):</p><pre class="programlisting prettyprint lang-js">def search = node.client.search {
    indices "test"
    types "type1"
    source {
        query {
            query_string(
                fields: ["test"],
                query: "value1 value2")
        }
    }
}</pre><p>Pagination (see
<a class="ulink" href="http://www.elasticsearch.org/guide/elasticsearch/reference/current/search-request-from-size.html" target="_top">from/size</a>):</p><pre class="programlisting prettyprint lang-js">def search = node.client.search {
    indices "test"
    types "type1"
    source {
        from = 0
        size = 10
        query {
            term(test: "value")
        }
    }
}</pre><p>Sorting (see <a class="ulink" href="http://www.elasticsearch.org/guide/elasticsearch/reference/current/search-request-sort.html" target="_top">sort</a>):</p><pre class="programlisting prettyprint lang-js">def search = node.client.search {
    indices "test"
    types "type1"
    source {
        query {
            term(test: "value")
        }
        sort = [
            date : [ order: "desc"]
        ]
    }
}</pre></div><div class="navfooter"><span class="prev"><a href="delete.html">
              « 
              Delete API</a>
           
        </span><span class="next">
           
          <a href="count.html">Count API
               » 
            </a></span></div></article></section></div></div></div><script type="text/javascript" src="http://www.elasticsearch.org/content/plugins/prettify-gc-syntax-highlighter/prettify.js?ver=3.5.2"></script><script type="text/javascript" src="http://www.elasticsearch.org/content/plugins/prettify-gc-syntax-highlighter/launch.js?ver=3.5.2"></script></body></html>
