<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Client</title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Java API" /><link rel="up" href="index.html" title="Java API" /><link rel="prev" href="java-api.html" title="Preface" /><link rel="next" href="index_.html" title="Index API" /><script type="text/javascript" src="http://www.elasticsearch.org/wp-includes/js/jquery/jquery.js?ver=1.8.3"></script><link rel="stylesheet" id="prettify-gc-syntax-highlighter-css" href="http://www.elasticsearch.org/content/plugins/prettify-gc-syntax-highlighter/prettify.css?ver=3.5.2" type="text/css" media="all" /><link rel="stylesheet" id="appStyles-css" href="http://www.elasticsearch.org/content/themes/elasticsearch-org/css/main.css?ver=1376314515" type="text/css" media="all" /><script type="text/javascript" src="http://www.elasticsearch.org/content/themes/elasticsearch-org/js/vendor/modernizr-2.6.1.min.js?ver=1"></script><script type="text/javascript" src="http://www.elasticsearch.org/content/themes/elasticsearch-org/js/vendor/selectivizr-min.js?ver=1"></script><script type="text/javascript" src="http://www.elasticsearch.org/content/themes/elasticsearch-org/js/plugins.min.js?ver=1375472072"></script><link rel="stylesheet" type="text/css" href="styles.css" /></head><body class="single single-guide"><div class="global_wrapper"><div id="index" class="page_content"><div class="container"><section class="full_width guide"><article class="guide_content"><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Java API</a></span> &gt; <span class="breadcrumb-node">Client</span></div><div class="navheader"><span class="prev"><a href="java-api.html">
              « 
              Preface</a>
           
        </span><span class="next">
           
          <a href="index_.html">Index API
               » 
            </a></span></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="client"></a>Client</h1></div></div></div><p>You can use the <span class="strong"><strong>java client</strong></span> in multiple ways:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Perform standard <a class="link" href="index_.html" title="Index API">index</a>, <a class="link" href="get.html" title="Get API">get</a>,
  <a class="link" href="delete.html" title="Delete API">delete</a> and <a class="link" href="search.html" title="Search API">search</a> operations on an
  existing cluster
</li><li class="listitem">
Perform administrative tasks on a running cluster
</li><li class="listitem">
Start full nodes when you want to run Elasticsearch embedded in your
  own application  or when you want to launch unit or integration tests
</li></ul></div><p>Obtaining an elasticsearch <code class="literal">Client</code> is simple. The most common way to
get a client is by:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
creating an embedded <a class="ulink" href="#nodeclient" target="_top"><code class="literal">Node</code></a> that acts as a node
within a cluster
</li><li class="listitem">
requesting a <code class="literal">Client</code> from your embedded <code class="literal">Node</code>.
</li></ol></div><p>Another manner is by creating a <a class="ulink" href="#transportclient" target="_top"><code class="literal">TransportClient</code></a>
that connects to a cluster.</p><p><span class="strong"><strong>Important:</strong></span></p><div class="blockquote"><blockquote class="blockquote"><p>Please note that you are encouraged to use the same version on client
and cluster sides. You may hit some incompatibilities issues when mixing
major versions.</p></blockquote></div><h3><a id="_node_client"></a>Node Client</h3><p>Instantiating a node based client is the simplest way to get a <code class="literal">Client</code>
that can execute operations against elasticsearch.</p><pre class="programlisting prettyprint lang-java">import static org.elasticsearch.node.NodeBuilder.*;

// on startup

Node node = nodeBuilder().node();
Client client = node.client();

// on shutdown

node.close();</pre><p>When you start a <code class="literal">Node</code>, it joins an elasticsearch cluster. You can have
different clusters by simple setting the <code class="literal">cluster.name</code> setting, or
explicitly using the <code class="literal">clusterName</code> method on the builder.</p><p>You can define <code class="literal">cluster.name</code> in <code class="literal">/src/main/resources/elasticsearch.yml</code>
dir in your project. As long as <code class="literal">elasticsearch.yml</code> is present in the
classloader, it will be used when you start your node.</p><pre class="programlisting prettyprint lang-java">cluster.name=yourclustername</pre><p>Or in Java:</p><pre class="programlisting prettyprint lang-java">Node node = nodeBuilder().clusterName("yourclustername").node();
Client client = node.client();</pre><p>The benefit of using the <code class="literal">Client</code> is the fact that operations are
automatically routed to the node(s) the operations need to be executed
on, without performing a "double hop". For example, the index operation
will automatically be executed on the shard that it will end up existing
at.</p><p>When you start a <code class="literal">Node</code>, the most important decision is whether it
should hold data or not. In other words, should indices and shards be
allocated to it. Many times we would like to have the clients just be
clients, without shards being allocated to them. This is simple to
configure by setting either <code class="literal">node.data</code> setting to <code class="literal">false</code> or
<code class="literal">node.client</code> to <code class="literal">true</code> (the <code class="literal">NodeBuilder</code> respective helper methods on
it):</p><pre class="programlisting prettyprint lang-java">import static org.elasticsearch.node.NodeBuilder.*;

// on startup

Node node = nodeBuilder().client(true).node();
Client client = node.client();

// on shutdown

node.close();</pre><p>Another common usage is to start the <code class="literal">Node</code> and use the <code class="literal">Client</code> in
unit/integration tests. In such a case, we would like to start a "local"
<code class="literal">Node</code> (with a "local" discovery and transport). Again, this is just a
matter of a simple setting when starting the <code class="literal">Node</code>. Note, "local" here
means local on the JVM (well, actually class loader) level, meaning that
two <span class="strong"><strong>local</strong></span> servers started within the same JVM will discover themselves
and form a cluster.</p><pre class="programlisting prettyprint lang-java">import static org.elasticsearch.node.NodeBuilder.*;

// on startup

Node node = nodeBuilder().local(true).node();
Client client = node.client();

// on shutdown

node.close();</pre><h3><a id="_transport_client"></a>Transport Client</h3><p>The <code class="literal">TransportClient</code> connects remotely to an elasticsearch cluster
using the transport module. It does not join the cluster, but simply
gets one or more initial transport addresses and communicates with them
in round robin fashion on each action (though most actions will probably
be "two hop" operations).</p><pre class="programlisting prettyprint lang-java">// on startup

Client client = new TransportClient()
        .addTransportAddress(new InetSocketTransportAddress("host1", 9300))
        .addTransportAddress(new InetSocketTransportAddress("host2", 9300));

// on shutdown

client.close();</pre><p>Note that you have to set the cluster name if you use one different to
"elasticsearch":</p><pre class="programlisting prettyprint lang-java">Settings settings = ImmutableSettings.settingsBuilder()
        .put("cluster.name", "myClusterName").build();
Client client =    new TransportClient(settings);
//Add transport addresses and do something with the client...</pre><p>Or using <code class="literal">elasticsearch.yml</code> file as shown in the <a class="ulink" href="#nodeclient" target="_top">Node
Client section</a></p><p>The client allows to sniff the rest of the cluster, and add those into
its list of machines to use. In this case, note that the ip addresses
used will be the ones that the other nodes were started with (the
"publish" address). In order to enable it, set the
<code class="literal">client.transport.sniff</code> to <code class="literal">true</code>:</p><pre class="programlisting prettyprint lang-java">Settings settings = ImmutableSettings.settingsBuilder()
        .put("client.transport.sniff", true).build();
TransportClient client = new TransportClient(settings);</pre><p>Other transport client level settings include:</p><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top">Parameter </th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">client.transport.ignore_cluster_name</code></p></td><td align="left" valign="top"><p>Set to <code class="literal">true</code> to ignore cluster
name validation of connected nodes. (since 0.19.4)</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">client.transport.ping_timeout</code></p></td><td align="left" valign="top"><p>The time to wait for a ping response
from a node. Defaults to <code class="literal">5s</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">client.transport.nodes_sampler_interval</code></p></td><td align="left" valign="top"><p>How often to sample / ping
the nodes listed and connected. Defaults to <code class="literal">5s</code>.</p></td></tr></tbody></table></div></div><div class="navfooter"><span class="prev"><a href="java-api.html">
              « 
              Preface</a>
           
        </span><span class="next">
           
          <a href="index_.html">Index API
               » 
            </a></span></div></article></section></div></div></div><script type="text/javascript" src="http://www.elasticsearch.org/content/plugins/prettify-gc-syntax-highlighter/prettify.js?ver=3.5.2"></script><script type="text/javascript" src="http://www.elasticsearch.org/content/plugins/prettify-gc-syntax-highlighter/launch.js?ver=3.5.2"></script></body></html>
