<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head xmlns="http://www.w3.org/1999/xhtml"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Intro</title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Rivers" /><link rel="up" href="index.html" title="Rivers" /><link rel="prev" href="index.html" title="Rivers" /><link rel="next" href="river-couchdb.html" title="CouchDB River" /><script xmlns="" type="text/javascript" src="http://www.elasticsearch.org/wp-includes/js/jquery/jquery.js?ver=1.8.3"></script><link xmlns="" rel="stylesheet" id="prettify-gc-syntax-highlighter-css" href="http://www.elasticsearch.org/content/plugins/prettify-gc-syntax-highlighter/prettify.css?ver=3.5.2" type="text/css" media="all" /><link xmlns="" rel="stylesheet" id="appStyles-css" href="http://www.elasticsearch.org/content/themes/elasticsearch-org/css/main.css?ver=1376314515" type="text/css" media="all" /><script xmlns="" type="text/javascript" src="http://www.elasticsearch.org/content/themes/elasticsearch-org/js/vendor/modernizr-2.6.1.min.js?ver=1"></script><script xmlns="" type="text/javascript" src="http://www.elasticsearch.org/content/themes/elasticsearch-org/js/vendor/selectivizr-min.js?ver=1"></script><script xmlns="" type="text/javascript" src="http://www.elasticsearch.org/content/themes/elasticsearch-org/js/plugins.min.js?ver=1375472072"></script><link xmlns="" rel="stylesheet" type="text/css" href="styles.css" /></head><body class="single single-guide"><div class="global_wrapper"><div id="index" class="page_content"><div class="container"><section class="full_width guide"><article class="guide_content"><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Rivers</a></span> &gt; <span class="breadcrumb-node">Intro</span></div><div class="navheader"><span class="prev">
           
        </span><span class="next">
           
          <a href="river-couchdb.html">CouchDB River
               » 
            </a></span></div><div xmlns="http://www.w3.org/1999/xhtml" class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="river"></a>Intro</h1></div></div></div><p>A river is a pluggable service running within elasticsearch cluster
pulling data (or being pushed with data) that is then indexed into the
cluster.</p><p>A river is composed of a unique name and a type. The type is the type of
the river (out of the box, there is the <code class="literal">dummy</code> river that simply logs
that it is running). The name uniquely identifies the river within the
cluster. For example, one can run a river called <code class="literal">my_river</code> with type
<code class="literal">dummy</code>, and another river called <code class="literal">my_other_river</code> with type <code class="literal">dummy</code>.</p><h2><a id="_how_it_works"></a>How it Works</h2><p>A river instance (and its name) is a type within the <code class="literal">_river</code> index. All
different rivers implementations accept a document called <code class="literal">_meta</code> that
at the very least has the type of the river (twitter / couchdb / …)
associated with it. Creating a river is a simple curl request to index
that <code class="literal">_meta</code> document (there is actually a <code class="literal">dummy</code> river used for
testing):</p><pre class="programlisting prettyprint lang-js">curl -XPUT 'localhost:9200/_river/my_river/_meta' -d '{
    "type" : "dummy"
}'</pre><p>A river can also have more data associated with it in the form of more
documents indexed under the given index type (the river name). For
example, storing the last indexed state can be stored in a document that
holds it.</p><p>Deleting a river is a call to delete the type (and all documents
associated with it):</p><pre class="programlisting prettyprint lang-js">curl -XDELETE 'localhost:9200/_river/my_river/'</pre><h2><a id="_cluster_allocation"></a>Cluster Allocation</h2><p>Rivers are singletons within the cluster. They get allocated
automatically to one of the nodes and run. If that node fails, an river
will be automatically allocated to another node.</p><p>River allocation on nodes can be controlled on each node. The
<code class="literal">node.river</code> can be set to <code class="literal">_none_</code> disabling any river allocation to
it. The <code class="literal">node.river</code> can also include a comma separated list of either
river names or types controlling the rivers allowed to run on it. For
example: <code class="literal">my_river1,my_river2</code>, or <code class="literal">dummy,twitter</code>.</p><h2><a id="_status"></a>Status</h2><p>Each river (regardless of the implementation) exposes a high level
<code class="literal">_status</code> doc which includes the node the river is running on. Getting
the status is a simple curl GET request to
<code class="literal">/_river/{river name}/_status</code>.</p></div><div class="navfooter"><span class="prev">
           
        </span><span class="next">
           
          <a href="river-couchdb.html">CouchDB River
               » 
            </a></span></div></article></section></div></div></div><script type="text/javascript" src="http://www.elasticsearch.org/content/plugins/prettify-gc-syntax-highlighter/prettify.js?ver=3.5.2"></script><script type="text/javascript" src="http://www.elasticsearch.org/content/plugins/prettify-gc-syntax-highlighter/launch.js?ver=3.5.2"></script></body></html>
