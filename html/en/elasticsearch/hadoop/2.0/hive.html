<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Apache Hive integration</title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch for Apache Hadoop [2.0]" /><link rel="up" href="reference.html" title="Reference" /><link rel="prev" href="cascading.html" title="Cascading support" /><link rel="next" href="pig.html" title="Apache Pig support" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta content="width=device-width, initial-scale=1.0" name="viewport" /><link rel="shortcut icon" href="//www.elasticsearch.org/content/themes/elasticsearch-org/favicon.ico" /><link rel="stylesheet" id="prettify-gc-syntax-highlighter-css" href="//www.elasticsearch.org/content/plugins/prettify-gc-syntax-highlighter/prettify.css?ver=3.5.2" type="text/css" media="all" /><link rel="stylesheet" id="appStyles-css" href="//www.elasticsearch.org/content/themes/elasticsearch-org/css/main.css?ver=1395693666" type="text/css" media="all" /><script type="text/javascript" src="//www.elasticsearch.org/wp-includes/js/jquery/jquery.js?ver=1.8.3"></script><link rel="stylesheet" href="//www.elasticsearch.org/content/themes/elasticsearch-org/style.css" type="text/css" media="all" /><script src="//cdn.optimizely.com/js/281975433.js"></script><script type="text/javascript">
      jQuery(function() {
        jQuery('div.navheader+div').css('minHeight',jQuery('div.toc').height()+'px');
        jQuery('article.guide_content a[id]').each(function() { this.href='#'+this.id });
      });
    </script><link rel="stylesheet" type="text/css" href="styles.css?3" /></head><body class="single single-guide"><!--Google Tag Manager--><script> dataLayer = []; </script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5FTL28" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><script>
    if(jQuery('body').data('cookie') != "eu" || jQuery.cookie('allowCookies')){
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5FTL28');}
</script><!--[if lt IE 8]>
        <p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
      <![endif]--><header><nav role="navigation" id="mobile-nav-container" class="off-canvas-nav"><ul id="mobile-nav" class="menu"><li id="menu-item-75892" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-75892"><a href="/overview/">Overview</a><ul class="sub-menu"><li id="menu-item-75895" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-75895"><a href="/overview/">Overview</a></li><li id="menu-item-68760" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-68760"><a href="/overview/elasticsearch/">Elasticsearch</a></li><li id="menu-item-75894" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-75894"><a href="/overview/marvel/">Marvel</a></li><li id="menu-item-68758" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-68758"><a href="/overview/kibana/">Kibana</a></li><li id="menu-item-68756" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-68756"><a href="/overview/kibana/installation/">Kibana Installation</a></li><li id="menu-item-68757" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-68757"><a href="/overview/kibana/support/">Kibana Support</a></li><li id="menu-item-68759" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-68759"><a href="/overview/logstash/">Logstash</a></li><li id="menu-item-74019" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-74019"><a href="/overview/hadoop/">Hadoop</a></li><li id="menu-item-75893" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-75893"><a href="/overview/elkdownloads/">ELK Downloads</a></li></ul></li><li id="menu-item-55" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-55"><a href="/resources/">Resources</a><ul class="sub-menu"><li id="menu-item-76342" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-76342"><a href="/guide/">Guide</a></li><li id="menu-item-4843" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4843"><a href="/videos/">Videos</a></li></ul></li><li id="menu-item-657" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-657"><a href="/community/">Community</a></li><li id="menu-item-68802" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-68802"><a href="/case-studies/">Case Studies</a></li><li id="menu-item-45" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-45"><a href="/blog/">Blog</a></li><li id="menu-item-12" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12"><a target="_blank" href="http://elasticsearch.com">Company</a></li></ul><ul class="add-on"><li><a href="/overview/elkdownloads/">Download</a></li></ul></nav><div class="container"><div id="header-inner"><h1 id="header-logo"><a class="faux" href="http://www.elasticsearch.org">Elasticsearch</a></h1><nav role="navigation" id="main-nav-container" class="main-nav"><ul id="top-nav" class="menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-75892"><a href="/overview/">Overview</a></li><li class="menu-item menu-item-type-post_type menu-item-object-page current-menu-item page_item page-item-53 current_page_item menu-item-55"><a href="/resources/">Resources</a></li><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-657"><a href="/community/">Community</a></li><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-68802"><a href="/case-studies/">Case Studies</a></li><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-45"><a href="/blog/">Blog</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12"><a target="_blank" href="http://elasticsearch.com">Company</a></li></ul><ul class="add-on"><li><a class="btn btn-primary" href="/overview/elkdownloads/">Download</a></li></ul></nav><div class="slide-trigger navigation" id="nav-trigger" aria-hidden="true"><span class="bar"></span><span class="bar"></span><span class="bar"></span></div><hr /><ul id="sub_nav"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-76342"><a href="/guide/">Guide</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4843"><a href="/videos/">Videos</a></li></ul></div></div></header><div class="global_wrapper"><div class="page_content"><div class="container"><section id="search_container" class="active"><form id="blog_search" role="search" action="/" method="get"><div class="blog_search_wrapper"><input id="s" name="s" class="search_term" type="text" placeholder="search" autocomplete="off" tabindex="1" /><input type="submit" class="search_submit" value=" " /><ul id="results"></ul></div></form></section><section class="full_width guide"><article class="guide_content"><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch for Apache Hadoop
      [2.0]
    </a></span> » <span class="breadcrumb-link"><a href="reference.html">Reference </a></span> » <span class="breadcrumb-node">Apache Hive integration</span></div><div class="navheader"><span class="prev"><a href="cascading.html">
              « 
              Cascading support</a>
           
        </span><span class="next">
           
          <a href="pig.html">Apache Pig support
               »
            </a></span></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="hive"></a>Apache Hive integration<a href="https://github.com/elasticsearch/elasticsearch-hadoop/edit/2.0/docs/src/reference/asciidoc/core/hive.adoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><div class="toc"><dl><dt><span class="chapter"><a href="arch.html">Architecture</a></span></dt><dt><span class="chapter"><a href="configuration.html">Configuration</a></span></dt><dt><span class="chapter"><a href="configuration-runtime.html">Hadoop runtime options</a></span></dt><dt><span class="chapter"><a href="logging.html">Logging</a></span></dt><dt><span class="chapter"><a href="mapreduce.html">Map/Reduce integration</a></span></dt><dt><span class="chapter"><a href="cascading.html">Cascading support</a></span></dt><dt><span class="chapter"><a href="hive.html">Apache Hive integration</a></span></dt><dt><span class="chapter"><a href="pig.html">Apache Pig support</a></span></dt><dt><span class="chapter"><a href="spark.html">Apache Spark support</a></span></dt><dt><span class="chapter"><a href="mapping.html">Mapping and Types</a></span></dt><dt><span class="chapter"><a href="metrics.html">Hadoop Metrics</a></span></dt><dt><span class="chapter"><a href="troubleshooting.html">Troubleshooting</a></span></dt></dl></div><div class="blockquote"><table border="0" class="blockquote" summary="Block quote"><tr><td width="10%" valign="top"> </td><td width="80%" valign="top"><p><a class="ulink" href="http://hive.apache.org/" target="_top">Hive</a> is a data warehouse system for Hadoop that facilitates easy data summarization, ad-hoc queries, and the analysis of large datasets stored in Hadoop compatible file systems.</p></td><td width="10%" valign="top"> </td></tr><tr><td width="10%" valign="top"> </td><td colspan="2" align="right" valign="top">--<span class="attribution">
Hive website
</span></td></tr></table></div><p>Hive abstracts Hadoop by abstracting it through SQL-like language, called HiveQL so that users can apply data defining and manipulating operations to it, just like with SQL. In Hive data set are <a class="ulink" href="https://cwiki.apache.org/confluence/display/Hive/GettingStarted#GettingStarted-DDLOperations" target="_top">defined</a> through <span class="emphasis"><em>tables</em></span> (that expose type information) in which data can be <a class="ulink" href="https://cwiki.apache.org/confluence/display/Hive/GettingStarted#GettingStarted-DMLOperations" target="_top">loaded</a>, <a class="ulink" href="https://cwiki.apache.org/confluence/display/Hive/GettingStarted#GettingStarted-SQLOperations" target="_top">selected and transformed</a> through built-in operators or custom/user defined functions (or <a class="ulink" href="https://cwiki.apache.org/confluence/display/Hive/OperatorsAndFunctions" target="_top">UDF</a>s).</p><h3><a id="_installation_3"></a>Installation<a href="https://github.com/elasticsearch/elasticsearch-hadoop/edit/2.0/docs/src/reference/asciidoc/core/hive.adoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>Make elasticsearch-hadoop jar available in the Hive classpath. Depending on your options, there are various <a class="ulink" href="https://cwiki.apache.org/confluence/display/Hive/HivePlugins#HivePlugins-DeployingjarsforUserDefinedFunctionsandUserDefinedSerDes" target="_top">ways</a> to achieve that. Use <a class="ulink" href="https://cwiki.apache.org/Hive/languagemanual-cli.html#LanguageManualCli-HiveResources" target="_top">ADD</a> command to add files, jars (what we want) or archives to the classpath:</p><pre class="screen">ADD /path/elasticsearch-hadoop.jar;</pre><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>the command expects a proper URI that can be found either on the local file-system or remotely. Typically it’s best to use a distributed file-system (like HDFS or Amazon S3) and use that since the script might be executed
on various machines.</p></div></div><p>As an alternative, one can use the command-line:</p><p><strong>CLI configuration. </strong>
</p><pre class="programlisting prettyprint lang-bash">$ bin/hive --auxpath=/path/elasticsearch-hadoop.jar</pre><p>
</p><p>or use the <code class="literal">hive.aux.jars.path</code> property specified either through the command-line or, if available, through if the <code class="literal">hive-site.xml</code> file, to register additional jars (that accepts an URI as well):</p><pre class="programlisting prettyprint lang-bash">$ bin/hive -hiveconf hive.aux.jars.path=/path/elasticsearch-hadoop.jar</pre><p>or if the <code class="literal">hive-site.xml</code> configuration can be modified, one can register additional jars through the <code class="literal">hive.aux.jars.path</code> option (that accepts an URI as well):</p><p><strong><code class="literal">hive-site.xml</code> configuration. </strong>
</p><pre class="programlisting prettyprint lang-xml">&lt;property&gt;
  &lt;name&gt;hive.aux.jars.path&lt;/name&gt;
  &lt;value&gt;/path/elasticsearch-hadoop.jar&lt;/value&gt;
  &lt;description&gt;A comma separated list (with no spaces) of the jar files&lt;/description&gt;
&lt;/property&gt;</pre><p>
</p><h3><a id="hive-configuration"></a>Configuration<a href="https://github.com/elasticsearch/elasticsearch-hadoop/edit/2.0/docs/src/reference/asciidoc/core/hive.adoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>When using Hive, one can use <code class="literal">TBLPROPERTIES</code> to specify the <a class="link" href="configuration.html" title="Configuration">configuration</a> properties (as an alternative to Hadoop <code class="literal">Configuration</code> object) when declaring the external table backed by Elasticsearch:</p><pre class="programlisting prettyprint lang-sql">CREATE EXTERNAL TABLE artists (...)
STORED BY 'org.elasticsearch.hadoop.hive.EsStorageHandler'
TBLPROPERTIES('es.resource' = 'radio/artists',
              'es.index.auto.create' = 'false') <a id="CO25-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO25-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
elasticsearch-hadoop setting
</p></td></tr></table></div><h3><a id="hive-alias"></a>Mapping<a href="https://github.com/elasticsearch/elasticsearch-hadoop/edit/2.0/docs/src/reference/asciidoc/core/hive.adoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>By default, elasticsearch-hadoop uses the Hive table schema to map the data in Elasticsearch, using both the field names and types in the process. There are cases however when the names in Hive cannot
be used with Elasticsearch (the field name can contain characters accepted by Elasticsearch but not by Hive). For such cases, one can use the <code class="literal">es.mapping.names</code> setting which accepts a comma-separated list of names mapping in the following format: <code class="literal">Hive field name</code>:<code class="literal">Elasticsearch field name</code></p><p>To wit:</p><pre class="programlisting prettyprint lang-sql">CREATE EXTERNAL TABLE artists (...)
STORED BY 'org.elasticsearch.hadoop.hive.EsStorageHandler'
TBLPROPERTIES('es.resource' = 'radio/artists',
            <a id="CO26-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>'es.mapping.names' = 'date:@timestamp <a id="CO26-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>, url:url_123 <a id="CO26-3"></a><span><img src="images/icons/callouts/3.png" alt="" /></span>');</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO26-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
name mapping for two fields
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO26-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Hive column <code class="literal">date</code> mapped in Elasticsearch to <code class="literal">@timestamp</code>
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO26-3"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Hive column <code class="literal">url</code> mapped in Elasticsearch to <code class="literal">url_123</code>
</p></td></tr></table></div><div class="tip admon"><div class="icon"><img alt="Tip" src="images/icons/tip.png" /></div><div class="admon_content"><p>Elasticsearch accepts only lower-case field name and, as such, elasticsearch-hadoop will always convert Hive column names to lower-case. This poses no issue as Hive is <span class="strong"><strong>case insensitive</strong></span>
however it is recommended to use the default Hive style and use upper-case names only for Hive commands and avoid mixed-case names.</p></div></div><h3><a id="_writing_data_to_elasticsearch_2"></a>Writing data to Elasticsearch<a href="https://github.com/elasticsearch/elasticsearch-hadoop/edit/2.0/docs/src/reference/asciidoc/core/hive.adoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>With elasticsearch-hadoop, Elasticsearch becomes just an external <a class="ulink" href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual`DDL#LanguageManualDDL-CreateTable" target="_top">table</a> in which data can be loaded or read from:</p><pre class="programlisting prettyprint lang-sql">CREATE EXTERNAL TABLE artists (
    id      BIGINT,
    name    STRING,
    links   STRUCT&lt;url:STRING, picture:STRING&gt;)
STORED BY 'org.elasticsearch.hadoop.hive.EsStorageHandler'<a id="CO27-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
TBLPROPERTIES('es.resource' = 'radio/artists'<a id="CO27-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>);

-- insert data to Elasticsearch from another table called 'source'
INSERT OVERWRITE TABLE artists
    SELECT NULL, s.name, named_struct('url', s.url, 'picture', s.picture)
                    FROM source s;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO27-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Elasticsearch Hive <code class="literal">StorageHandler</code>
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO27-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Elasticsearch resource (index and type) associated with the given storage
</p></td></tr></table></div><h4><a id="writing-json-hive"></a>Writing existing JSON to Elasticsearch<a href="https://github.com/elasticsearch/elasticsearch-hadoop/edit/2.0/docs/src/reference/asciidoc/core/hive.adoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>For cases where the job output data is already in JSON, elasticsearch-hadoop allows direct indexing <span class="emphasis"><em>without</em></span> applying any transformation; the data is taken as is and sent directly to Elasticsearch. In such cases, one needs to indicate the json input by setting
the <code class="literal">es.input.json</code> parameter. As such, in this case elasticsearch-hadoop expects the output table to contain only one field, who
s content is used as the JSON document. That is, the library will recognize specific <span class="emphasis"><em>textual</em></span> types (such as <code class="literal">string</code> or <code class="literal">binary</code>) or simply call (<code class="literal">toString</code>).</p><div class="table"><a id="id-1.3.9.30"></a><p class="title"><strong>Table 3. Hive types to use for JSON representation</strong></p><div class="table-contents"><table summary="Hive types to use for JSON representation" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="center" valign="top"> <code class="literal">Hive type</code> </th><th align="center" valign="top"> Comment</th></tr></thead><tbody><tr><td align="center" valign="top"><p><code class="literal">binary</code></p></td><td align="center" valign="top"><p>use this when the JSON data is represented as a <code class="literal">byte[]</code> or similar</p></td></tr><tr><td align="center" valign="top"><p><code class="literal">string</code></p></td><td align="center" valign="top"><p>use this if the JSON data is represented as a <code class="literal">String</code></p></td></tr><tr><td align="center" valign="top"><p><span class="emphasis"><em>anything else</em></span></p></td><td align="center" valign="top"><p>make sure the <code class="literal">toString()</code> returns the desired JSON document</p></td></tr><tr><td colspan="2" align="center" valign="top"><p><span class="strong"><strong>Available in Hive 0.12 or higher</strong></span></p></td></tr><tr><td align="center" valign="top"><p><code class="literal">varchar</code></p></td><td align="center" valign="top"><p>use this as an alternative to Hive <code class="literal">string</code></p></td></tr></tbody></table></div></div><br class="table-break" /><div class="important admon"><div class="icon"><img alt="Important" src="images/icons/important.png" /></div><div class="admon_content"><p>Make sure the data is properly encoded, in <code class="literal">UTF-8</code>. The field content is considered the final form of the document sent to Elasticsearch.</p></div></div><pre class="programlisting prettyprint lang-java">CREATE EXTERNAL TABLE json (data STRING<a id="CO28-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>)
STORED BY 'org.elasticsearch.hadoop.hive.EsStorageHandler'
TBLPROPERTIES('es.resource' = '...',
              'es.input.json` = 'yes'<a id="CO28-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>);
...</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO28-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The table declaration only one field of type <code class="literal">STRING</code>
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO28-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Indicate elasticsearch-hadoop the table content is in JSON format
</p></td></tr></table></div><h4><a id="_writing_to_dynamic_multi_resources_2"></a>Writing to dynamic/multi-resources<a href="https://github.com/elasticsearch/elasticsearch-hadoop/edit/2.0/docs/src/reference/asciidoc/core/hive.adoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>One can index the data to a different resource, depending on the <span class="emphasis"><em>row</em></span> being read, by using patterns. Coming back to the aforementioned <a class="link" href="configuration.html#cfg-multi-writes" title="Dynamic/multi resource writesedit">media example</a>, one could configure it as follows:</p><pre class="programlisting prettyprint lang-sql">CREATE EXTERNAL TABLE media (
    name    STRING,
    type    STRING,<a id="CO29-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
    year    STRING,
STORED BY 'org.elasticsearch.hadoop.hive.EsStorageHandler'
TBLPROPERTIES('es.resource' = 'my-collection/{type}'<a id="CO29-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>);</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO29-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Table field used by the resource pattern. Any of the declared fields can be used.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO29-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Resource pattern using field <code class="literal">type</code>
</p></td></tr></table></div><p>For each <span class="emphasis"><em>row</em></span> about to be written, elasticsearch-hadoop will extract the <code class="literal">type</code> field and use its value to determine the target resource.</p><p>The functionality is also available when dealing with raw JSON - in this case, the value will be extracted from the JSON document itself. Assuming the JSON source contains documents with the following structure:</p><pre class="programlisting prettyprint lang-js">{
    "media_type":"music",<a id="CO30-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
    "title":"Surfing With The Alien",
    "year":"1987"
}</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO30-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
field within the JSON document that will be used by the pattern
</p></td></tr></table></div><p>the table declaration can be as follows:</p><pre class="programlisting prettyprint lang-sql">CREATE EXTERNAL TABLE json (data STRING<a id="CO31-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>)
STORED BY 'org.elasticsearch.hadoop.hive.EsStorageHandler'
TBLPROPERTIES('es.resource' = 'my-collection/{media_type}'<a id="CO31-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>,
              'es.input.json` = 'yes');</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO31-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Schema declaration for the table. Since JSON input is used, the schema is simply a holder to the raw data
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO31-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Resource pattern relying on fields <span class="emphasis"><em>within</em></span> the JSON document and <span class="emphasis"><em>not</em></span> on the table schema
</p></td></tr></table></div><h3><a id="_reading_data_from_elasticsearch_3"></a>Reading data from Elasticsearch<a href="https://github.com/elasticsearch/elasticsearch-hadoop/edit/2.0/docs/src/reference/asciidoc/core/hive.adoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>Reading from Elasticsearch is strikingly similar:</p><pre class="programlisting prettyprint lang-sql">CREATE EXTERNAL TABLE artists (
    id      BIGINT,
    name    STRING,
    links   STRUCT&lt;url:STRING, picture:STRING&gt;)
STORED BY 'org.elasticsearch.hadoop.hive.EsStorageHandler'<a id="CO32-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
TBLPROPERTIES('es.resource' = 'radio/artists'<a id="CO32-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>, 'es.query' = '?q=me*'<a id="CO32-3"></a><span><img src="images/icons/callouts/3.png" alt="" /></span>);

-- stream data from Elasticsearch
SELECT * FROM artists;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO32-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
same Elasticsearch Hive <code class="literal">StorageHandler</code>
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO32-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Elasticsearch resource
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO32-3"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Elasticsearch query
</p></td></tr></table></div><h3><a id="hive-type-conversion"></a>Type conversion<a href="https://github.com/elasticsearch/elasticsearch-hadoop/edit/2.0/docs/src/reference/asciidoc/core/hive.adoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><div class="important admon"><div class="icon"><img alt="Important" src="images/icons/important.png" /></div><div class="admon_content"><p>If automatic index creation is used, please review <a class="link" href="mapping.html#auto-mapping-type-loss">this</a> section for more information.</p></div></div><p>Hive provides various <a class="ulink" href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual`Types" target="_top">types</a> for defining data and internally uses different implementations depending on the target environment (from JDK native types to binary-optimized ones). Elasticsearch integrates with all of them, including
and Serde2 <a class="ulink" href="http://hive.apache.org/javadocs/r0.12.0/api/index.html?org/apache/hadoop/hive/serde2/lazy/package-summary.html" target="_top">lazy</a> and <a class="ulink" href="http://hive.apache.org/javadocs/r0.12.0/api/index.html?org/apache/hadoop/hive/serde2/lazybinary/package-summary.html" target="_top">lazy binary</a>:</p><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="center" valign="top"> Hive type </th><th align="center" valign="top"> Elasticsearch type</th></tr></thead><tbody><tr><td align="center" valign="top"><p><code class="literal">void</code></p></td><td align="center" valign="top"><p><code class="literal">null</code></p></td></tr><tr><td align="center" valign="top"><p><code class="literal">boolean</code></p></td><td align="center" valign="top"><p><code class="literal">boolean</code></p></td></tr><tr><td align="center" valign="top"><p><code class="literal">tinyint</code></p></td><td align="center" valign="top"><p><code class="literal">byte</code></p></td></tr><tr><td align="center" valign="top"><p><code class="literal">smallint</code></p></td><td align="center" valign="top"><p><code class="literal">short</code></p></td></tr><tr><td align="center" valign="top"><p><code class="literal">int</code></p></td><td align="center" valign="top"><p><code class="literal">int</code></p></td></tr><tr><td align="center" valign="top"><p><code class="literal">bigint</code></p></td><td align="center" valign="top"><p><code class="literal">long</code></p></td></tr><tr><td align="center" valign="top"><p><code class="literal">double</code></p></td><td align="center" valign="top"><p><code class="literal">double</code></p></td></tr><tr><td align="center" valign="top"><p><code class="literal">float</code></p></td><td align="center" valign="top"><p><code class="literal">float</code></p></td></tr><tr><td align="center" valign="top"><p><code class="literal">string</code></p></td><td align="center" valign="top"><p><code class="literal">string</code></p></td></tr><tr><td align="center" valign="top"><p><code class="literal">binary</code></p></td><td align="center" valign="top"><p><code class="literal">binary</code></p></td></tr><tr><td align="center" valign="top"><p><code class="literal">timestamp</code></p></td><td align="center" valign="top"><p><code class="literal">date</code></p></td></tr><tr><td align="center" valign="top"><p><code class="literal">struct</code></p></td><td align="center" valign="top"><p><code class="literal">map</code></p></td></tr><tr><td align="center" valign="top"><p><code class="literal">map</code></p></td><td align="center" valign="top"><p><code class="literal">map</code></p></td></tr><tr><td align="center" valign="top"><p><code class="literal">array</code></p></td><td align="center" valign="top"><p><code class="literal">array</code></p></td></tr><tr><td align="center" valign="top"><p><code class="literal">union</code></p></td><td align="center" valign="top"><p>not supported (yet)</p></td></tr><tr><td colspan="2" align="center" valign="top"><p><span class="strong"><strong>Available in Hive 0.11 or higher</strong></span></p></td></tr><tr><td align="center" valign="top"><p><code class="literal">decimal</code></p></td><td align="center" valign="top"><p><code class="literal">string</code></p></td></tr><tr><td colspan="2" align="center" valign="top"><p><span class="strong"><strong>Available in Hive 0.12 or higher</strong></span></p></td></tr><tr><td align="center" valign="top"><p><code class="literal">date</code></p></td><td align="center" valign="top"><p><code class="literal">date</code></p></td></tr><tr><td align="center" valign="top"><p><code class="literal">varchar</code></p></td><td align="center" valign="top"><p><code class="literal">string</code></p></td></tr><tr><td colspan="2" align="center" valign="top"><p><span class="strong"><strong>Available in Hive 0.13 or higher</strong></span></p></td></tr><tr><td align="center" valign="top"><p><code class="literal">char</code></p></td><td align="center" valign="top"><p><code class="literal">string</code></p></td></tr></tbody></table></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>While Elasticsearch understands Hive types up to version 0.13, it is backwards compatible with Hive 0.9</p></div></div></div><div class="navfooter"><span class="prev"><a href="cascading.html">
              « 
              Cascading support</a>
           
        </span><span class="next">
           
          <a href="pig.html">Apache Pig support
               »
            </a></span></div></article></section></div></div></div><footer><div id="footer_container" class="full_wrapper"><div class="container"><nav role="navigation"><ul id="footer_nav" class="menu"><li id="menu-item-36" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-36"><a target="_blank" href="http://elasticsearch.com">Company</a></li><li id="menu-item-74980" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-74980"><a href="/resources/">Resources</a></li><li id="menu-item-3106" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3106"><a href="/terms-of-use/">Terms</a></li><li id="menu-item-3107" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3107"><a href="/privacy-and-cookie-policy/">Privacy</a></li><li id="menu-item-3105" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3105"><a href="/contact/">Contact</a></li><li id="menu-item-39" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-39"><a href="/blog/">Blog</a></li></ul></nav><div id="social"><a href="https://twitter.com/elasticsearch" class="social_icons" target="_blank"><i class="twitter"></i></a><a href="https://www.facebook.com/elasticsearch" class="social_icons" target="_blank"><i class="facebook"></i></a></div><div id="footer_form"><label class="form_label">Sign up for updates!</label><div class="gf_browser_chrome gform_wrapper" id="gform_wrapper_4"><a id="gf_4" name="gf_4" class="gform_anchor"></a><form method="post" enctype="multipart/form-data" target="gform_ajax_frame_4" id="gform_4" action="/empty-template/#gf_4"><div class="gform_body"><ul id="gform_fields_4" class="gform_fields top_label description_below"><li id="field_4_6" class="gfield               gfield_contains_required"><label class="gfield_label" for="input_4_6">enter you email<span class="gfield_required">*</span></label><div class="ginput_container"><input name="input_6" id="input_4_6" type="email" value="" class="medium" tabindex="50" /></div></li><li id="field_4_2" class="gfield     gform_hidden"><input name="input_2" id="input_4_2" type="hidden" class="gform_hidden" value="813-MAM-392" /></li><li id="field_4_3" class="gfield     gform_hidden"><input name="input_3" id="input_4_3" type="hidden" class="gform_hidden" value="WEB.org" /></li><li id="field_4_4" class="gfield     gform_hidden"><input name="input_4" id="input_4_4" type="hidden" class="gform_hidden" value="WEB.org - Footer - Updates" /></li></ul></div><script type="text/javascript">//<![CDATA[
            jQuery(function(){
                jQuery('#gform_submit_button_4').click( function() {
                    if(window["gf_submitting_4"]){
                        return false;
                    }
                    if( !jQuery("#gform_4")[0].checkValidity || jQuery("#gform_4")[0].checkValidity()){
                        window["gf_submitting_4"]=true;
                    }
                });
            });
            //]]></script><div class="gform_footer top_label"><input type="submit" id="gform_submit_button_4" class="button gform_button" value="Submit" tabindex="51" /><input type="hidden" name="gform_ajax" value="form_id=4&amp;title=&amp;description=" /><input type="hidden" class="gform_hidden" name="is_submit_4" value="1" /><input type="hidden" class="gform_hidden" name="gform_submit" value="4" /><input type="hidden" class="gform_hidden" name="gform_unique_id" value="" /><input type="hidden" class="gform_hidden" name="state_4" value="WyJhOjA6e30iLCJmMjE2MmM2ZjUxYmQ4M2Q3ZmMzNzVlNmY2ODYyZTI2NCJd" /><input type="hidden" class="gform_hidden" name="gform_target_page_number_4" id="gform_target_page_number_4" value="0" /><input type="hidden" class="gform_hidden" name="gform_source_page_number_4" id="gform_source_page_number_4" value="1" /><input type="hidden" name="gform_field_values" value="" /></div></form></div><iframe style="display:none;width:0px; height:0px;" src="about:blank" name="gform_ajax_frame_4" id="gform_ajax_frame_4"></iframe><script type="text/javascript">//<![CDATA[
                    function gformInitSpinner_4(){jQuery('#gform_4').submit(function(){if(jQuery('#gform_ajax_spinner_4').length == 0){jQuery('#gform_submit_button_4, #gform_wrapper_4 .gform_next_button, #gform_wrapper_4 .gform_image_button').after('<' + 'img id="gform_ajax_spinner_4"  class="gform_ajax_spinner" src="//www.elasticsearch.org/content/plugins/gravityforms/images/spinner.gif" alt="" />'); }} );}jQuery(document).ready(function($){gformInitSpinner_4();jQuery('#gform_ajax_frame_4').load( function(){var contents = jQuery(this).contents().find('*').html();var is_postback = contents.indexOf('GF_AJAX_POSTBACK') >= 0;if(!is_postback){return;}var form_content = jQuery(this).contents().find('#gform_wrapper_4');var is_redirect = contents.indexOf('gformRedirect(){') >= 0;var is_form = !(form_content.length <= 0 || is_redirect);if(is_form){jQuery('#gform_wrapper_4').html(form_content.html());jQuery(document).scrollTop(jQuery('#gform_wrapper_4').offset().top);if(window['gformInitDatepicker']) {gformInitDatepicker();}if(window['gformInitPriceFields']) {gformInitPriceFields();}var current_page = jQuery('#gform_source_page_number_4').val();gformInitSpinner_4();jQuery(document).trigger('gform_page_loaded', [4, current_page]);window['gf_submitting_4'] = false;}else if(!is_redirect){var confirmation_content = jQuery(this).contents().find('#gforms_confirmation_message').html();if(!confirmation_content){confirmation_content = contents;}setTimeout(function(){jQuery('#gform_wrapper_4').replaceWith('<' + 'div id=\'gforms_confirmation_message\' class=\'gform_confirmation_message_4\'' + '>' + confirmation_content + '<' + '/div' + '>');jQuery(document).scrollTop(jQuery('#gforms_confirmation_message').offset().top);jQuery(document).trigger('gform_confirmation_loaded', [4]);window['gf_submitting_4'] = false;}, 50);}else{jQuery('#gform_4').append(contents);if(window['gformRedirect']) {gformRedirect();}}jQuery(document).trigger('gform_post_render', [4, current_page]);} );} );</script><script type='text/javascript'> jQuery(document).ready(function(){jQuery(document).trigger('gform_post_render', [4, 1]) } );
                    //]]></script></div><div class="legal"><p>© 2014 All Rights Reserved - Elasticsearch </p><p>Apache Lucene and Lucene are trademarks of the Apache Software Foundation</p></div></div></div></footer><section id="cookie"><div class="container"><div class="eu">
                Elasticsearch uses cookies to provide a better user experience to visitors of our website. Read more about our cookie policy <a href="/privacy-and-cookie-policy/">here.</a><a data-action="accept" class="cta">Accept cookies</a></div><div class="uk">
                Elasticsearch uses cookies to provide a better user experience to visitors of our website. Read more about our cookie policy <a href="/privacy-and-cookie-policy/">here.</a><a data-action="dismiss" class="cta dismiss">X</a></div></div></section><script type="text/javascript">
      if (window.aiModifyParent) aiModifyParent();
      (function ($, $a, $title, $list) {
        $a = $('[id^="js-api-method-index"]');
        if (!$a.size()) return;
        $('.guide_content').addClass('js-client-docs');
        $list = $a.siblings('.itemizedlist').detach();
        $title = $(document.createElement('h2')).text('api methods')
        $a.parent().remove();
        $('.toc').first().append($(document.createElement('div')).addClass('js-api-method-index').append($title).append($list));
      }(jQuery));
    </script><script type="text/javascript">if(window.aiModifyParent) {aiModifyParent();}</script><script type="text/javascript" src="//www.elasticsearch.org/content/plugins/prettify-gc-syntax-highlighter/prettify.js?ver=3.5.2"></script><script type="text/javascript" src="//www.elasticsearch.org/content/plugins/prettify-gc-syntax-highlighter/launch.js?ver=3.5.2"></script><script type="text/javascript" src="//s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201413"></script><script type="text/javascript" src="//www.elasticsearch.org/content/themes/elasticsearch-org/js/global.min.js?ver=1395082599"></script><script type="text/javascript" src="//www.elasticsearch.org/content/themes/elasticsearch-org/js/froogaloop.min.js?ver=1"></script></body></html>
