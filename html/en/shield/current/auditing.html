<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Auditing</title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Shield - Elasticsearch Security Plugin" /><link rel="up" href="index.html" title="Shield - Elasticsearch Security Plugin" /><link rel="prev" href="ip-filtering.html" title="IP filtering" /><link rel="next" href="clients.html" title="Integrating Shield with clients" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta content="width=device-width, initial-scale=1.0" name="viewport" /><link rel="shortcut icon" href="//www.elasticsearch.org/content/themes/elasticsearch-org/favicon.ico" /><link rel="stylesheet" id="prettify-gc-syntax-highlighter-css" href="//www.elasticsearch.org/content/plugins/prettify-gc-syntax-highlighter/prettify.css?ver=3.5.2" type="text/css" media="all" /><link rel="stylesheet" id="appStyles-css" href="//www.elasticsearch.org/content/themes/elasticsearch-org/css/main.css?ver=1395693666" type="text/css" media="all" /><script type="text/javascript" src="//www.elasticsearch.org/wp-includes/js/jquery/jquery.js?ver=1.8.3"></script><link rel="stylesheet" href="//www.elasticsearch.org/content/themes/elasticsearch-org/style.css" type="text/css" media="all" /><script src="//cdn.optimizely.com/js/281975433.js"></script><script type="text/javascript">
      jQuery(function() {
        jQuery('div.navheader+div').css('minHeight',jQuery('div.toc').height()+'px');
        jQuery('article.guide_content a[id]').each(function() { this.href='#'+this.id });
      });
    </script><link rel="stylesheet" type="text/css" href="styles.css?3" /></head><body class="single single-guide"><!--Google Tag Manager--><script> dataLayer = []; </script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5FTL28" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><script>
    if(jQuery('body').data('cookie') != "eu" || jQuery.cookie('allowCookies')){
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5FTL28');}
</script><!--[if lt IE 8]>
        <p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
      <![endif]--><header><nav role="navigation" id="mobile-nav-container" class="off-canvas-nav"><ul id="mobile-nav" class="menu"><li id="menu-item-75892" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-75892"><a href="/overview/">Overview</a><ul class="sub-menu"><li id="menu-item-75895" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-75895"><a href="/overview/">Overview</a></li><li id="menu-item-68760" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-68760"><a href="/overview/elasticsearch/">Elasticsearch</a></li><li id="menu-item-75894" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-75894"><a href="/overview/marvel/">Marvel</a></li><li id="menu-item-68758" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-68758"><a href="/overview/kibana/">Kibana</a></li><li id="menu-item-68756" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-68756"><a href="/overview/kibana/installation/">Kibana Installation</a></li><li id="menu-item-68757" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-68757"><a href="/overview/kibana/support/">Kibana Support</a></li><li id="menu-item-68759" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-68759"><a href="/overview/logstash/">Logstash</a></li><li id="menu-item-74019" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-74019"><a href="/overview/hadoop/">Hadoop</a></li><li id="menu-item-75893" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-75893"><a href="/overview/elkdownloads/">ELK Downloads</a></li></ul></li><li id="menu-item-55" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-55"><a href="/resources/">Resources</a><ul class="sub-menu"><li id="menu-item-76342" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-76342"><a href="/guide/">Guide</a></li><li id="menu-item-4843" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4843"><a href="/videos/">Videos</a></li></ul></li><li id="menu-item-657" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-657"><a href="/community/">Community</a></li><li id="menu-item-68802" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-68802"><a href="/case-studies/">Case Studies</a></li><li id="menu-item-45" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-45"><a href="/blog/">Blog</a></li><li id="menu-item-12" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12"><a target="_blank" href="http://elasticsearch.com">Company</a></li></ul><ul class="add-on"><li><a href="/overview/elkdownloads/">Download</a></li></ul></nav><div class="container"><div id="header-inner"><h1 id="header-logo"><a class="faux" href="http://www.elasticsearch.org">Elasticsearch</a></h1><nav role="navigation" id="main-nav-container" class="main-nav"><ul id="top-nav" class="menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-75892"><a href="/overview/">Overview</a></li><li class="menu-item menu-item-type-post_type menu-item-object-page current-menu-item page_item page-item-53 current_page_item menu-item-55"><a href="/resources/">Resources</a></li><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-657"><a href="/community/">Community</a></li><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-68802"><a href="/case-studies/">Case Studies</a></li><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-45"><a href="/blog/">Blog</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12"><a target="_blank" href="http://elasticsearch.com">Company</a></li></ul><ul class="add-on"><li><a class="btn btn-primary" href="/overview/elkdownloads/">Download</a></li></ul></nav><div class="slide-trigger navigation" id="nav-trigger" aria-hidden="true"><span class="bar"></span><span class="bar"></span><span class="bar"></span></div><hr /><ul id="sub_nav"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-76342"><a href="/guide/">Guide</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4843"><a href="/videos/">Videos</a></li></ul></div></div></header><div class="global_wrapper"><div class="page_content"><div class="container"><section id="search_container" class="active"><form id="blog_search" role="search" action="/" method="get"><div class="blog_search_wrapper"><input id="s" name="s" class="search_term" type="text" placeholder="search" autocomplete="off" tabindex="1" /><input type="submit" class="search_submit" value=" " /><ul id="results"></ul></div></form></section><section class="full_width guide"><article class="guide_content"><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Shield - Elasticsearch Security Plugin</a></span> » <span class="breadcrumb-node">Auditing</span></div><div class="navheader"><span class="prev"><a href="ip-filtering.html">
              « 
              IP filtering</a>
           
        </span><span class="next">
           
          <a href="clients.html">Integrating Shield with clients
               »
            </a></span></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="auditing"></a>Auditing</h1></div></div></div><div class="toc"><dl><dt><span class="chapter"><a href="introduction.html">Introduction</a></span></dt><dt><span class="chapter"><a href="architecture.html">Architecture Overview</a></span></dt><dt><span class="chapter"><a href="getting-started.html">Getting Started</a></span></dt><dt><span class="chapter"><a href="authorization.html">Authorization</a></span></dt><dt><span class="chapter"><a href="authentication.html">Authentication</a></span></dt><dt><span class="chapter"><a href="securing-nodes.html">Securing Nodes</a></span></dt><dt><span class="chapter"><a href="auditing.html">Auditing</a></span></dt><dt><span class="chapter"><a href="clients.html">Integrating Shield with clients</a></span></dt><dt><span class="chapter"><a href="certificate-authority.html">Appendix 1. Running a Certificate Authority</a></span></dt><dt><span class="chapter"><a href="license-management.html">Appendix 2. License Management</a></span></dt><dt><span class="chapter"><a href="limitations.html">Appendix 3. Limitations</a></span></dt><dt><span class="chapter"><a href="securing-aliases.html">Appendix 4. Securing Indices &amp; Aliases</a></span></dt><dt><span class="chapter"><a href="tribe-node.html">Appendix 5. Tribe Node</a></span></dt><dt><span class="chapter"><a href="example.html">Appendix 6. Full <code class="literal">esusers</code> Example</a></span></dt><dt><span class="chapter"><a href="trouble-shooting.html">Appendix 7. Trouble Shooting</a></span></dt><dt><span class="chapter"><a href="reference.html">Appendix 8. Reference</a></span></dt></dl></div><div class="important admon"><div class="icon"><img alt="Important" src="images/icons/important.png" /></div><div class="admon_content"><p>Audit logs are <span class="strong"><strong>disabled</strong></span> by default. To enable this functionality the following setting should be added to the
<code class="literal">elasticsearch.yml</code> file:</p><pre class="programlisting prettyprint lang-yaml">shield.audit.enabled: true</pre></div></div><p>The audit functionality was added to keep track of important events occurring in elasticsearch, primarily around security
concerns. Keeping track and persisting these events is essential for any secured environment and potentially provides
evidence for suspicious/malicious activity on the elasticsearch cluster.</p><p>Currently, the only output for these events are dedicated <code class="literal">access.log</code> files stored on the host’s file system.</p><h3><a id="_log_entry_types"></a>Log Entry Types</h3><p>Each audit related event that occurs is represented by a single log entry of a specific type (the type represents the
type of the event that occurred). Here are the possible log entry types:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<code class="literal">anonymous_access_denied</code>          is logged when the request is denied due to missing authentication token.
</li><li class="listitem">
<code class="literal">authentication_failed</code>            is logged when the authentication token cannot be matched to a known user.
</li><li class="listitem">
<code class="literal">authentication_failed [&lt;realm&gt;]</code>  is logged for every realm that fails to present a valid authentication token.
                                     The value of <span class="emphasis"><em>&lt;realm&gt;</em></span> is the realm type.
</li><li class="listitem">
<code class="literal">access_denied</code>                    is logged when an authenticated user attempts an action the user does not have the
                                     <a class="link" href="reference.html" title="Appendix 8. Reference">privilege</a> to perform.
</li><li class="listitem">
<code class="literal">access_granted</code>                   is logged when an authenticated user attempts an action the user has the correct
                                     privilege to perform. In TRACE level all system (internal) actions are logged as
                                     well (in all other level they’re not logged to avoid cluttering of the logs.
</li><li class="listitem">
<code class="literal">tampered_request</code>                 is logged when the request was detected to be tampered (typically relates to <code class="literal">search/scroll</code> requests when the scroll id is believed to be tampered)
</li><li class="listitem">
<code class="literal">connection_granted</code>               is logged when an incoming tcp connection has passed the ip filtering for a specific profile
</li><li class="listitem">
<code class="literal">connection_denied</code>                is logged when an incoming tcp connection did not pass the ip filtering for a specific profile
</li></ul></div><p>To avoid needless proliferation of log entries, Shield enables you to control what entry types should be logged. This can
be done by setting the logging level. The following table lists the log entry types that will be logged for each of the
possible log levels:</p><div class="table"><a id="id-1.8.9"></a><p class="title"><strong>Table 7. Log Entry Types and Levels</strong></p><div class="table-contents"><table summary="Log Entry Types and Levels" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top"> Log Level </th><th align="left" valign="top"> Entry Type</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">ERROR</code></p></td><td align="left" valign="top"><p><code class="literal">authentication_failed</code>, <code class="literal">access_denied</code>, <code class="literal">tampered_request</code>, <code class="literal">connection_denied</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">WARN</code></p></td><td align="left" valign="top"><p><code class="literal">authentication_failed</code>, <code class="literal">access_denied</code>, <code class="literal">tampered_request</code>, <code class="literal">connection_denied</code>, <code class="literal">anonymous_access_denied</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">INFO</code></p></td><td align="left" valign="top"><p><code class="literal">authentication_failed</code>, <code class="literal">access_denied</code>, <code class="literal">tampered_request</code>, <code class="literal">connection_denied</code>, <code class="literal">anonymous_access_denied</code>, <code class="literal">access_granted</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">DEBUG</code></p></td><td align="left" valign="top"><p>(doesn’t output additional entry types beyond <code class="literal">INFO</code>, but extends the information emitted for each entry (see <a class="link" href="auditing.html#audit-log-entry-format" title="Log Entry Format">Log Entry Format</a> below)</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">TRACE</code></p></td><td align="left" valign="top"><p><code class="literal">authentication_failed</code>, <code class="literal">access_denied</code>, <code class="literal">tampered_request</code>, <code class="literal">connection_denied</code>, <code class="literal">anonymous_access_denied</code>, <code class="literal">access_granted</code>, <code class="literal">connection_granted</code>, <code class="literal">authentication_failed [&lt;realm&gt;]</code>. In addition, internal system requests (self-management requests triggered by elasticsearch itself) will also be logged for <code class="literal">access_granted</code> entry type.</p></td></tr></tbody></table></div></div><br class="table-break" /><h3><a id="audit-log-entry-format"></a>Log Entry Format</h3><p>As mentioned above, every log entry represents an event that occurred in the system. As such, each entry is associated with
a timestamp (at which the event occurred), the component/layer the event is associated with and the entry/event type. In
addition, every log entry (depending ot its type) carries addition information about the event.</p><p>The format of a log entry is shown below:</p><pre class="programlisting prettyprint lang-txt">[&lt;timestamp&gt;] [&lt;local_node_info] [&lt;layer&gt;] [&lt;entry_type&gt;] &lt;attribute_list&gt;</pre><p>Where:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<code class="literal">&lt;timestamp&gt;</code> -           the timestamp of the entries (in the fomrat configured in <code class="literal">logging.yml</code> as shown above)
</li><li class="listitem">
<code class="literal">&lt;local_node_info</code> -      additional information about the local node that this log entry is printed from (the <a class="link" href="auditing.html#audit-log-entry-local-node-info" title="Table 8. Local Node Info Settings">table below</a> shows how this information can be controlled via settings)
</li><li class="listitem">
<code class="literal">&lt;layer&gt;</code> -               the layer from which this entry relates to. Can be either <code class="literal">rest</code>, <code class="literal">transport</code> or <code class="literal">ip_filter</code>
</li><li class="listitem">
<code class="literal">&lt;entry_type&gt;</code> -          the type of the entry as discussed above. Can be either <code class="literal">anonymous_access_denied</code>, <code class="literal">authentication_failed</code>,
                            <code class="literal">access_denied</code>, <code class="literal">access_granted</code>, <code class="literal">connection_granted</code>, <code class="literal">connection_denied</code>.
</li><li class="listitem">
<code class="literal">&lt;attribute_list&gt;</code> -       A comma-separated list of attribute carrying data relevant to the occurred event (formatted as <code class="literal">attr1=[val1], attr2=[val2],...</code>)
</li></ul></div><div class="table"><a id="audit-log-entry-local-node-info"></a><p class="title"><strong>Table 8. Local Node Info Settings</strong></p><div class="table-contents"><table summary="Local Node Info Settings" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th align="left" valign="top"> Name                                                   </th><th align="left" valign="top"> Default   </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">shield.audit.logfile.prefix.emit_node_name</code></p></td><td align="left" valign="top"><p>true</p></td><td align="left" valign="top"><p>When set to <code class="literal">true</code>, the local node’s name will be emitted</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">shield.audit.logfile.prefix.emit_node_host_address</code></p></td><td align="left" valign="top"><p>false</p></td><td align="left" valign="top"><p>When set to <code class="literal">true</code>, the local node’s IP address will be emitted</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">shield.audit.logfile.prefix.emit_node_host_name</code></p></td><td align="left" valign="top"><p>false</p></td><td align="left" valign="top"><p>When set to <code class="literal">true</code>, the local node’s host name will be emitted</p></td></tr></tbody></table></div></div><br class="table-break" /><p>The following tables describe the possible attributes each entry type can carry (the attributes that will be available depend on the configured log level):</p><div class="table"><a id="id-1.8.18"></a><p class="title"><strong>Table 9. <code class="literal">[rest] [anonymous_access_denied]</code> attributes</strong></p><div class="table-contents"><table summary="[rest] [anonymous_access_denied] attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th align="left" valign="top"> Attribute             </th><th align="left" valign="top"> Minimum Log Level     </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">origin_address</code></p></td><td align="left" valign="top"><p>WARN</p></td><td align="left" valign="top"><p>The address the rest request origins from</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">uri</code></p></td><td align="left" valign="top"><p>WARN</p></td><td align="left" valign="top"><p>The REST endpoint URI</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request_body</code></p></td><td align="left" valign="top"><p>DEBUG</p></td><td align="left" valign="top"><p>The body of the request</p></td></tr></tbody></table></div></div><br class="table-break" /><div class="table"><a id="id-1.8.19"></a><p class="title"><strong>Table 10. <code class="literal">[rest] [authentication_failed]</code> attributes</strong></p><div class="table-contents"><table summary="[rest] [authentication_failed] attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th align="left" valign="top"> Attribute             </th><th align="left" valign="top"> Minimum Log Level     </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">origin_address</code></p></td><td align="left" valign="top"><p>ERROR</p></td><td align="left" valign="top"><p>The address the rest request origins from</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">principal</code></p></td><td align="left" valign="top"><p>ERROR</p></td><td align="left" valign="top"><p>The principal (username) that failed to authenticate</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">uri</code></p></td><td align="left" valign="top"><p>ERROR</p></td><td align="left" valign="top"><p>The REST endpoint URI</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request_body</code></p></td><td align="left" valign="top"><p>DEBUG</p></td><td align="left" valign="top"><p>The body of the request</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">realm</code></p></td><td align="left" valign="top"><p>TRACE</p></td><td align="left" valign="top"><p>The realm that failed to authenticate the user. NOTE: A separate entry will be printed for each of the consulted realms</p></td></tr></tbody></table></div></div><br class="table-break" /><div class="table"><a id="id-1.8.20"></a><p class="title"><strong>Table 11. <code class="literal">[transport] [anonymous_access_denied]</code> attributes</strong></p><div class="table-contents"><table summary="[transport] [anonymous_access_denied] attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th align="left" valign="top"> Attribute             </th><th align="left" valign="top"> Minimum Log Level     </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">origin_type</code></p></td><td align="left" valign="top"><p>WARN</p></td><td align="left" valign="top"><p>The type of the origin the request originated from. Can be either <code class="literal">rest</code> (request was originated from a rest API request), <code class="literal">transport</code> (request received on the transport channel), <code class="literal">local_node</code> (the local node issued the request)</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">origin_address</code></p></td><td align="left" valign="top"><p>WARN</p></td><td align="left" valign="top"><p>The address the request origins from</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">action</code></p></td><td align="left" valign="top"><p>WARN</p></td><td align="left" valign="top"><p>The name of the action that was executed</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request</code></p></td><td align="left" valign="top"><p>DEBUG</p></td><td align="left" valign="top"><p>The type of the request that was executed</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">indices</code></p></td><td align="left" valign="top"><p>WARN</p></td><td align="left" valign="top"><p>A comma-separated list of indices this request relates to (when applicable)</p></td></tr></tbody></table></div></div><br class="table-break" /><div class="table"><a id="id-1.8.21"></a><p class="title"><strong>Table 12. <code class="literal">[transport] [authentication_failed]</code> attributes</strong></p><div class="table-contents"><table summary="[transport] [authentication_failed] attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th align="left" valign="top"> Attribute             </th><th align="left" valign="top"> Minimum Log Level      </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">origin_type</code></p></td><td align="left" valign="top"><p>ERROR</p></td><td align="left" valign="top"><p>The type of the origin the request originated from. Can be either <code class="literal">rest</code> (request was originated from a rest API request), <code class="literal">transport</code> (request received on the transport channel), <code class="literal">local_node</code> (the local node issued the request)</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">origin_address</code></p></td><td align="left" valign="top"><p>ERROR</p></td><td align="left" valign="top"><p>The address the request origins from</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">principal</code></p></td><td align="left" valign="top"><p>ERROR</p></td><td align="left" valign="top"><p>The principal (username) that failed to authenticate</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">action</code></p></td><td align="left" valign="top"><p>ERROR</p></td><td align="left" valign="top"><p>The name of the action that was executed</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request</code></p></td><td align="left" valign="top"><p>DEBUG</p></td><td align="left" valign="top"><p>The type of the request that was executed</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">indices</code></p></td><td align="left" valign="top"><p>ERROR</p></td><td align="left" valign="top"><p>A comma-separated list of indices this request relates to (when applicable)</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">realm</code></p></td><td align="left" valign="top"><p>TRACE</p></td><td align="left" valign="top"><p>The realm that failed to authenticate the user. NOTE: A separate entry will be printed for each of the consulted realms</p></td></tr></tbody></table></div></div><br class="table-break" /><div class="table"><a id="id-1.8.22"></a><p class="title"><strong>Table 13. <code class="literal">[transport] [access_granted]</code> attributes</strong></p><div class="table-contents"><table summary="[transport] [access_granted] attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th align="left" valign="top"> Attribute             </th><th align="left" valign="top"> Minimum Log Level     </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">origin_type</code></p></td><td align="left" valign="top"><p>INFO</p></td><td align="left" valign="top"><p>The type of the origin the request originated from. Can be either <code class="literal">rest</code> (request was originated from a rest API request), <code class="literal">transport</code> (request received on the transport channel), <code class="literal">local_node</code> (the local node issued the request)</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">origin_address</code></p></td><td align="left" valign="top"><p>INFO</p></td><td align="left" valign="top"><p>The address the request origins from</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">principal</code></p></td><td align="left" valign="top"><p>INFO</p></td><td align="left" valign="top"><p>The principal (username) that failed to authenticate</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">action</code></p></td><td align="left" valign="top"><p>INFO</p></td><td align="left" valign="top"><p>The name of the action that was executed</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request</code></p></td><td align="left" valign="top"><p>DEBUG</p></td><td align="left" valign="top"><p>The type of the request that was executed</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">indices</code></p></td><td align="left" valign="top"><p>INFO</p></td><td align="left" valign="top"><p>A comma-separated list of indices this request relates to (when applicable)</p></td></tr></tbody></table></div></div><br class="table-break" /><div class="table"><a id="id-1.8.23"></a><p class="title"><strong>Table 14. <code class="literal">[transport] [access_denied]</code> attributes</strong></p><div class="table-contents"><table summary="[transport] [access_denied] attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th align="left" valign="top"> Attribute             </th><th align="left" valign="top"> Minimum Log Level     </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">origin_type</code></p></td><td align="left" valign="top"><p>ERROR</p></td><td align="left" valign="top"><p>The type of the origin the request originated from. Can be either <code class="literal">rest</code> (request was originated from a rest API request), <code class="literal">transport</code> (request received on the transport channel), <code class="literal">local_node</code> (the local node issued the request)</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">origin_address</code></p></td><td align="left" valign="top"><p>ERROR</p></td><td align="left" valign="top"><p>The address the request origins from</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">principal</code></p></td><td align="left" valign="top"><p>ERROR</p></td><td align="left" valign="top"><p>The principal (username) that failed to authenticate</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">action</code></p></td><td align="left" valign="top"><p>ERROR</p></td><td align="left" valign="top"><p>The name of the action that was executed</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request</code></p></td><td align="left" valign="top"><p>DEBUG</p></td><td align="left" valign="top"><p>The type of the request that was executed</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">indices</code></p></td><td align="left" valign="top"><p>ERROR</p></td><td align="left" valign="top"><p>A comma-separated list of indices this request relates to (when applicable)</p></td></tr></tbody></table></div></div><br class="table-break" /><div class="table"><a id="id-1.8.24"></a><p class="title"><strong>Table 15. <code class="literal">[transport] [tampered_request]</code> attributes</strong></p><div class="table-contents"><table summary="[transport] [tampered_request] attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th align="left" valign="top"> Attribute             </th><th align="left" valign="top"> Minimum Log Level     </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">origin_type</code></p></td><td align="left" valign="top"><p>ERROR</p></td><td align="left" valign="top"><p>The type of the origin the request originated from. Can be either <code class="literal">rest</code> (request was originated from a rest API request), <code class="literal">transport</code> (request received on the transport channel), <code class="literal">local_node</code> (the local node issued the request)</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">origin_address</code></p></td><td align="left" valign="top"><p>ERROR</p></td><td align="left" valign="top"><p>The address the request origins from</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">principal</code></p></td><td align="left" valign="top"><p>ERROR</p></td><td align="left" valign="top"><p>The principal (username) that failed to authenticate</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">action</code></p></td><td align="left" valign="top"><p>ERROR</p></td><td align="left" valign="top"><p>The name of the action that was executed</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request</code></p></td><td align="left" valign="top"><p>DEBUG</p></td><td align="left" valign="top"><p>The type of the request that was executed</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">indices</code></p></td><td align="left" valign="top"><p>ERROR</p></td><td align="left" valign="top"><p>A comma-separated list of indices this request relates to (when applicable)</p></td></tr></tbody></table></div></div><br class="table-break" /><div class="table"><a id="id-1.8.25"></a><p class="title"><strong>Table 16. <code class="literal">[ip_filter] [connection_granted]</code> attributes</strong></p><div class="table-contents"><table summary="[ip_filter] [connection_granted] attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th align="left" valign="top"> Attribute             </th><th align="left" valign="top"> Minimum Log Level     </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">origin_address</code></p></td><td align="left" valign="top"><p>TRACE</p></td><td align="left" valign="top"><p>The address the request origins from</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">transport_profile</code></p></td><td align="left" valign="top"><p>TRACE</p></td><td align="left" valign="top"><p>The principal (username) that failed to authenticate</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">rule</code></p></td><td align="left" valign="top"><p>TRACE</p></td><td align="left" valign="top"><p>The IP filtering rule that granted the request</p></td></tr></tbody></table></div></div><br class="table-break" /><div class="table"><a id="id-1.8.26"></a><p class="title"><strong>Table 17. <code class="literal">[ip_filter] [connection_denied]</code> attributes</strong></p><div class="table-contents"><table summary="[ip_filter] [connection_denied] attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th align="left" valign="top"> Attribute             </th><th align="left" valign="top"> Minimum Log Level     </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">origin_address</code></p></td><td align="left" valign="top"><p>ERROR</p></td><td align="left" valign="top"><p>The address the request origins from</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">transport_profile</code></p></td><td align="left" valign="top"><p>ERROR</p></td><td align="left" valign="top"><p>The principal (username) that failed to authenticate</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">rule</code></p></td><td align="left" valign="top"><p>ERROR</p></td><td align="left" valign="top"><p>The IP filtering rule that denied the request</p></td></tr></tbody></table></div></div><br class="table-break" /><h3><a id="_audit_logs_settings"></a>Audit Logs Settings</h3><p>As mentioned above, the audit logs are configured in the <code class="literal">logging.yml</code> file located in Shield’s <a class="link" href="getting-started.html#shield-config">config</a>
directory. The following snippet shows the default logging configuration:</p><p><a id="logging-file"></a><strong>Default <code class="literal">logging.yml</code> File. </strong>
</p><pre class="programlisting prettyprint lang-yaml">logger:
  shield.audit.logfile: INFO, access_log

additivity:
  shield.audit.logfile: false

appender:

  access_log:
    type: dailyRollingFile
    file: ${path.logs}/${cluster.name}-access.log
    datePattern: "'.'yyyy-MM-dd"
    layout:
      type: pattern
      conversionPattern: "[%d{ISO8601}] %m%n"</pre><p>
</p><p>As can be seen above, by default audit information is appended to the <code class="literal">access.log</code> file located in the
standard elasticsearch <code class="literal">logs</code> directory (typically located at <code class="literal">$ES_HOME/logs</code>).</p></div><div class="navfooter"><span class="prev"><a href="ip-filtering.html">
              « 
              IP filtering</a>
           
        </span><span class="next">
           
          <a href="clients.html">Integrating Shield with clients
               »
            </a></span></div></article></section></div></div></div><footer><div id="footer_container" class="full_wrapper"><div class="container"><nav role="navigation"><ul id="footer_nav" class="menu"><li id="menu-item-36" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-36"><a target="_blank" href="http://elasticsearch.com">Company</a></li><li id="menu-item-74980" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-74980"><a href="/resources/">Resources</a></li><li id="menu-item-3106" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3106"><a href="/terms-of-use/">Terms</a></li><li id="menu-item-3107" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3107"><a href="/privacy-and-cookie-policy/">Privacy</a></li><li id="menu-item-3105" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3105"><a href="/contact/">Contact</a></li><li id="menu-item-39" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-39"><a href="/blog/">Blog</a></li></ul></nav><div id="social"><a href="https://twitter.com/elasticsearch" class="social_icons" target="_blank"><i class="twitter"></i></a><a href="https://www.facebook.com/elasticsearch" class="social_icons" target="_blank"><i class="facebook"></i></a></div><div id="footer_form"><label class="form_label">Sign up for updates!</label><div class="gf_browser_chrome gform_wrapper" id="gform_wrapper_4"><a id="gf_4" name="gf_4" class="gform_anchor"></a><form method="post" enctype="multipart/form-data" target="gform_ajax_frame_4" id="gform_4" action="/empty-template/#gf_4"><div class="gform_body"><ul id="gform_fields_4" class="gform_fields top_label description_below"><li id="field_4_6" class="gfield               gfield_contains_required"><label class="gfield_label" for="input_4_6">enter you email<span class="gfield_required">*</span></label><div class="ginput_container"><input name="input_6" id="input_4_6" type="email" value="" class="medium" tabindex="50" /></div></li><li id="field_4_2" class="gfield     gform_hidden"><input name="input_2" id="input_4_2" type="hidden" class="gform_hidden" value="813-MAM-392" /></li><li id="field_4_3" class="gfield     gform_hidden"><input name="input_3" id="input_4_3" type="hidden" class="gform_hidden" value="WEB.org" /></li><li id="field_4_4" class="gfield     gform_hidden"><input name="input_4" id="input_4_4" type="hidden" class="gform_hidden" value="WEB.org - Footer - Updates" /></li></ul></div><script type="text/javascript">//<![CDATA[
            jQuery(function(){
                jQuery('#gform_submit_button_4').click( function() {
                    if(window["gf_submitting_4"]){
                        return false;
                    }
                    if( !jQuery("#gform_4")[0].checkValidity || jQuery("#gform_4")[0].checkValidity()){
                        window["gf_submitting_4"]=true;
                    }
                });
            });
            //]]></script><div class="gform_footer top_label"><input type="submit" id="gform_submit_button_4" class="button gform_button" value="Submit" tabindex="51" /><input type="hidden" name="gform_ajax" value="form_id=4&amp;title=&amp;description=" /><input type="hidden" class="gform_hidden" name="is_submit_4" value="1" /><input type="hidden" class="gform_hidden" name="gform_submit" value="4" /><input type="hidden" class="gform_hidden" name="gform_unique_id" value="" /><input type="hidden" class="gform_hidden" name="state_4" value="WyJhOjA6e30iLCJmMjE2MmM2ZjUxYmQ4M2Q3ZmMzNzVlNmY2ODYyZTI2NCJd" /><input type="hidden" class="gform_hidden" name="gform_target_page_number_4" id="gform_target_page_number_4" value="0" /><input type="hidden" class="gform_hidden" name="gform_source_page_number_4" id="gform_source_page_number_4" value="1" /><input type="hidden" name="gform_field_values" value="" /></div></form></div><iframe style="display:none;width:0px; height:0px;" src="about:blank" name="gform_ajax_frame_4" id="gform_ajax_frame_4"></iframe><script type="text/javascript">//<![CDATA[
                    function gformInitSpinner_4(){jQuery('#gform_4').submit(function(){if(jQuery('#gform_ajax_spinner_4').length == 0){jQuery('#gform_submit_button_4, #gform_wrapper_4 .gform_next_button, #gform_wrapper_4 .gform_image_button').after('<' + 'img id="gform_ajax_spinner_4"  class="gform_ajax_spinner" src="//www.elasticsearch.org/content/plugins/gravityforms/images/spinner.gif" alt="" />'); }} );}jQuery(document).ready(function($){gformInitSpinner_4();jQuery('#gform_ajax_frame_4').load( function(){var contents = jQuery(this).contents().find('*').html();var is_postback = contents.indexOf('GF_AJAX_POSTBACK') >= 0;if(!is_postback){return;}var form_content = jQuery(this).contents().find('#gform_wrapper_4');var is_redirect = contents.indexOf('gformRedirect(){') >= 0;var is_form = !(form_content.length <= 0 || is_redirect);if(is_form){jQuery('#gform_wrapper_4').html(form_content.html());jQuery(document).scrollTop(jQuery('#gform_wrapper_4').offset().top);if(window['gformInitDatepicker']) {gformInitDatepicker();}if(window['gformInitPriceFields']) {gformInitPriceFields();}var current_page = jQuery('#gform_source_page_number_4').val();gformInitSpinner_4();jQuery(document).trigger('gform_page_loaded', [4, current_page]);window['gf_submitting_4'] = false;}else if(!is_redirect){var confirmation_content = jQuery(this).contents().find('#gforms_confirmation_message').html();if(!confirmation_content){confirmation_content = contents;}setTimeout(function(){jQuery('#gform_wrapper_4').replaceWith('<' + 'div id=\'gforms_confirmation_message\' class=\'gform_confirmation_message_4\'' + '>' + confirmation_content + '<' + '/div' + '>');jQuery(document).scrollTop(jQuery('#gforms_confirmation_message').offset().top);jQuery(document).trigger('gform_confirmation_loaded', [4]);window['gf_submitting_4'] = false;}, 50);}else{jQuery('#gform_4').append(contents);if(window['gformRedirect']) {gformRedirect();}}jQuery(document).trigger('gform_post_render', [4, current_page]);} );} );</script><script type='text/javascript'> jQuery(document).ready(function(){jQuery(document).trigger('gform_post_render', [4, 1]) } );
                    //]]></script></div><div class="legal"><p>© 2014 All Rights Reserved - Elasticsearch </p><p>Apache Lucene and Lucene are trademarks of the Apache Software Foundation</p></div></div></div></footer><section id="cookie"><div class="container"><div class="eu">
                Elasticsearch uses cookies to provide a better user experience to visitors of our website. Read more about our cookie policy <a href="/privacy-and-cookie-policy/">here.</a><a data-action="accept" class="cta">Accept cookies</a></div><div class="uk">
                Elasticsearch uses cookies to provide a better user experience to visitors of our website. Read more about our cookie policy <a href="/privacy-and-cookie-policy/">here.</a><a data-action="dismiss" class="cta dismiss">X</a></div></div></section><script type="text/javascript">
      if (window.aiModifyParent) aiModifyParent();
      (function ($, $a, $title, $list) {
        $a = $('[id^="js-api-method-index"]');
        if (!$a.size()) return;
        $('.guide_content').addClass('js-client-docs');
        $list = $a.siblings('.itemizedlist').detach();
        $title = $(document.createElement('h2')).text('api methods')
        $a.parent().remove();
        $('.toc').first().append($(document.createElement('div')).addClass('js-api-method-index').append($title).append($list));
      }(jQuery));
    </script><script type="text/javascript">if(window.aiModifyParent) {aiModifyParent();}</script><script type="text/javascript" src="//www.elasticsearch.org/content/plugins/prettify-gc-syntax-highlighter/prettify.js?ver=3.5.2"></script><script type="text/javascript" src="//www.elasticsearch.org/content/plugins/prettify-gc-syntax-highlighter/launch.js?ver=3.5.2"></script><script type="text/javascript" src="//s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201413"></script><script type="text/javascript" src="//www.elasticsearch.org/content/themes/elasticsearch-org/js/global.min.js?ver=1395082599"></script><script type="text/javascript" src="//www.elasticsearch.org/content/themes/elasticsearch-org/js/froogaloop.min.js?ver=1"></script></body></html>
